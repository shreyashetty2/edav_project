[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "NYC Building Violation Analysis",
    "section": "",
    "text": "1 Introduction\nThe reason we chose this topic is because we are international students who recently moved to New York City to pursue MS in Data Science at Columbia University and we had faced a lot of issues trying to find a decent apartment in a well maintained building with minimum housing violations within a safe neighborhood. We feel this data is not very easily available to the public since we had to go through a lot of trouble to find the number of violations, compliance, and turnaround time taken by management to fix those issues. We aim to perform exploratory data analysis on NYC open datasets including data regarding building violations, permits, maintenance violations, and 311 requests to provide insights and understand patterns of violations in boroughs/regions and how the management responds to these vital issues in such a densely populated city. The insights we provide will be helpful to identify areas with comparatively less maintenance problems and also help understand the relationship between complaints, violations, and proactive improvement/repair by the management or city.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "data.html",
    "href": "data.html",
    "title": "2  Data",
    "section": "",
    "text": "2.1 Key distributions in Dataset\nThere are 2 dataset links that we will utilize from https://opendata.cityofnewyork.us. It is public data published by New York City agencies and other partners. As per our discussions during proposal approval, we have limited to 2 datasets (earlier we targeted 4) and downloaded filtered data for past 3 years and for Borough “Manhattan”.\nThe 2 datsets we are making use of from NYC Open Data are\nBoth the datasets are CSV files in tabular format and they are updated daily. The HPD dataset is published by the Department of Housing Preservation and Development and contains one row per housing code violation, with about 10.4 million rows and 41 columns. It includes things like identifiers (ViolationID, BuildingID, BBL), address and borough, violation class (A/B/C/I), detailed text descriptions, multiple status dates, and basic geography. On the other hand, the 311 dataset is maintained by NYC’s 311 system and has around 41.5 million rows. It has one row per service request and the key fields include a unique request ID, the responding agency, complaint type and descriptor, creation and closure times, and several location fields such as address, ZIP, BBL, and latitude/longitude. We observed that in the 311 documentation that the “Agency Name” column is currently unreliable, so have informed us to use the “Agency” code instead.\nPlease note, that the entire data was too huge so we did not make use of it entirely and instead filtered it for analysis. For HPD housing violations, we restrict it to Manhattan from the year 2022 onwards and so the dataset has 589,005 rows and 41 columns. Same goes with 311 requests dataset as we filter it for Manhattan and for the same time period. It now has, 425,248 rows and 42 columns. To make the two of them comparable, we created new categorical variables: in the violations data, we used regular expressions on the free text NOVDescription field to assign each violation to a broad issue type (such as HEAT/HOT WATER, PLUMBING, PAINT/PLASTER, WATER LEAK, DOOR/WINDOW/LOCK, or PEST/SANITATION). And so in 311 data we mapped Complaint Type (and, for pest issues, Complaint Type together with Descriptor) into the same set of issue types.\nAdditionally, we looked at some of the key distributions in the data to have a better understanding (see below). In HPD violations data, the most common CurrentStatus values are “VIOLATION DISMISSED”, “VIOLATION CLOSED”, and “NOV SENT OUT”, with a long list of more specific statuses such as “FIRST NO ACCESS TO RE-INSPECT VIOLATION” and “NOT COMPLIED WITH.” In the 311 data, housing related complaints are mostly dominated by a few Complaint Type categories like HEAT/HOT WATER, PLUMBING, PAINT/PLASTER, and WATER LEAK.\nCode\n# Libraries\nlibrary(dplyr)\n\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\n\nCode\nlibrary(lubridate)\n\n\n\nAttaching package: 'lubridate'\n\n\nThe following objects are masked from 'package:base':\n\n    date, intersect, setdiff, union\n\n\nCode\nlibrary(janitor)\n\n\n\nAttaching package: 'janitor'\n\n\nThe following objects are masked from 'package:stats':\n\n    chisq.test, fisher.test\n\n\nCode\nlibrary(ggplot2)\nlibrary(ggalluvial)\nlibrary(tidyr)\nlibrary(scales)\nlibrary(data.table)\n\n\n\nAttaching package: 'data.table'\n\n\nThe following objects are masked from 'package:lubridate':\n\n    hour, isoweek, mday, minute, month, quarter, second, wday, week,\n    yday, year\n\n\nThe following objects are masked from 'package:dplyr':\n\n    between, first, last\n\n\nCode\nlibrary(readr)\n\n\n\nAttaching package: 'readr'\n\n\nThe following object is masked from 'package:scales':\n\n    col_factor\n\n\nCode\nlibrary(tidyverse)\n\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ forcats 1.0.1     ✔ stringr 1.6.0\n✔ purrr   1.1.0     ✔ tibble  3.3.0\n\n\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ data.table::between() masks dplyr::between()\n✖ readr::col_factor()   masks scales::col_factor()\n✖ purrr::discard()      masks scales::discard()\n✖ dplyr::filter()       masks stats::filter()\n✖ data.table::first()   masks dplyr::first()\n✖ data.table::hour()    masks lubridate::hour()\n✖ data.table::isoweek() masks lubridate::isoweek()\n✖ dplyr::lag()          masks stats::lag()\n✖ data.table::last()    masks dplyr::last()\n✖ data.table::mday()    masks lubridate::mday()\n✖ data.table::minute()  masks lubridate::minute()\n✖ data.table::month()   masks lubridate::month()\n✖ data.table::quarter() masks lubridate::quarter()\n✖ data.table::second()  masks lubridate::second()\n✖ purrr::transpose()    masks data.table::transpose()\n✖ data.table::wday()    masks lubridate::wday()\n✖ data.table::week()    masks lubridate::week()\n✖ data.table::yday()    masks lubridate::yday()\n✖ data.table::year()    masks lubridate::year()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\n\nCode\nlibrary(forcats)\nlibrary(stringr)\nlibrary(redav)\n# ========== HOUSING VIOLATIONS ==========\nhousing_raw &lt;- read.csv(\"/Users/shreyashetty/Documents/Fall 2025 Courses/EDAV/Final_Project/edav_project/datasets/Housing_Violations_2022_onwards.csv\")\n\n# ========== 311 HOUSING COMPLAINTS ==========\nsr311_raw   &lt;- read.csv(\"/Users/shreyashetty/Documents/Fall 2025 Courses/EDAV/Final_Project/edav_project/datasets/311_Housing_Complaints_2022_onwards.csv\")\n\n\n# ========== KEY DISTRIBUTIONS ==========\n\n# Use tidyverse counting (no data.table .N)\n\nhousing_copy &lt;- housing_raw\nsr311_copy &lt;- sr311_raw\n\n# Housing Violations - Top 10 Current Status (showing top 10 since there are many unique values)\n\nhousing_copy |&gt;\n  filter(!is.na(CurrentStatus)) |&gt;\n    count(CurrentStatus, sort = TRUE) |&gt;\n      slice_head(n = 10) |&gt;\n        print()\n\n\n                              CurrentStatus      n\n1                       VIOLATION DISMISSED 197906\n2                          VIOLATION CLOSED 180829\n3                              NOV SENT OUT 112090\n4  FIRST NO ACCESS TO RE- INSPECT VIOLATION  18629\n5                         NOT COMPLIED WITH  17976\n6                         INFO NOV SENT OUT  12927\n7         NOTICE OF ISSUANCE SENT TO TENANT  11160\n8             VIOLATION WILL BE REINSPECTED  10263\n9                              CIV14 MAILED   7244\n10                     DEFECT LETTER ISSUED   5934\n\n\nCode\n# 311 Complaints - Top 10 Complaint Types (showing top 10)\n\nsr311_copy |&gt;\n  filter(!is.na(Complaint.Type)) |&gt;\n    count(Complaint.Type, sort = TRUE) |&gt;\n      slice_head(n = 10) |&gt;\n        print()\n\n\n                  Complaint.Type      n\n1                 HEAT/HOT WATER 229222\n2                       PLUMBING  50637\n3                  PAINT/PLASTER  44624\n4                     WATER LEAK  30190\n5  General Construction/Plumbing  25207\n6        Maintenance or Facility  20202\n7                       Elevator  16588\n8                       Plumbing   2197\n9                       ELEVATOR   1302\n10          Non-Residential Heat   1094\n\n\nCode\n# 311 Complaints - Status distribution\n\nsr311_copy |&gt;\n  filter(!is.na(Status)) |&gt;\n    count(Status, sort = TRUE) |&gt;\n      print()\n\n\n       Status      n\n1      Closed 419047\n2        Open   5152\n3 In Progress    922\n4    Assigned    124\n5 Unspecified      3\n\n\nCode\n# 311 Complaints - Top Agencies\n\nsr311_copy |&gt;\n  filter(!is.na(Agency)) |&gt;\n    count(Agency, sort = TRUE) |&gt;\n      slice_head(n = 10) |&gt;\n        print()\n\n\n  Agency      n\n1    HPD 358603\n2    DOB  43687\n3    DPR  20202\n4  DOHMH   1579\n5    DOE   1064\n6    DEP     99\n7    DOT     14",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Data</span>"
    ]
  },
  {
    "objectID": "data.html#description",
    "href": "data.html#description",
    "title": "2  Data",
    "section": "2.1 Description",
    "text": "2.1 Description",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Data</span>"
    ]
  },
  {
    "objectID": "data.html#missing-value-analysis",
    "href": "data.html#missing-value-analysis",
    "title": "2  Data",
    "section": "2.2 Missing Value Analysis",
    "text": "2.2 Missing Value Analysis\n\n2.2.1 Missing Data summary:\n\n\nCode\n# === HOUSING VIOLATIONS ===\n\n# Calculate missing counts and percentages\nmissing_housing &lt;- housing_raw |&gt;\n  summarise(across(everything(), ~ sum(is.na(.)))) |&gt;\n    pivot_longer(everything(), names_to = \"column\", values_to = \"missing_count\") |&gt;\n      mutate(total = nrow(housing_raw), missing_pct = round(100 * missing_count / total, 2)) |&gt;\n        arrange(desc(missing_pct))\n\n# Columns with missing values more than 0%\nprint(filter(missing_housing, missing_pct &gt; 0))\n\n\n# A tibble: 10 × 4\n   column          missing_count  total missing_pct\n   &lt;chr&gt;                   &lt;int&gt;  &lt;int&gt;       &lt;dbl&gt;\n 1 Story                   77094 589005       13.1 \n 2 NOVID                   34593 589005        5.87\n 3 BIN                       305 589005        0.05\n 4 BBL                       305 589005        0.05\n 5 Postcode                  147 589005        0.02\n 6 Latitude                   77 589005        0.01\n 7 Longitude                  77 589005        0.01\n 8 CommunityBoard             77 589005        0.01\n 9 CouncilDistrict            77 589005        0.01\n10 CensusTract                77 589005        0.01\n\n\nCode\n# === 311 COMPLAINTS ===\n\n# Calculate missing counts and percentages\nmissing_311 &lt;- sr311_raw |&gt;\n  summarise(across(everything(), ~ sum(is.na(.)))) |&gt;\n    pivot_longer(everything(), names_to = \"column\", values_to = \"missing_count\") |&gt;\n      mutate(total = nrow(sr311_raw), missing_pct = round(100 * missing_count / total, 2)) |&gt;\n        arrange(desc(missing_pct))\n\n# Columns with &gt;0% missing\nprint(filter(missing_311, missing_pct &gt; 0))\n\n\n# A tibble: 9 × 4\n  column                   missing_count  total missing_pct\n  &lt;chr&gt;                            &lt;int&gt;  &lt;int&gt;       &lt;dbl&gt;\n1 Due.Date                        425248 425248      100   \n2 Vehicle.Type                    425248 425248      100   \n3 Taxi.Company.Borough            425248 425248      100   \n4 Taxi.Pick.Up.Location           425248 425248      100   \n5 Bridge.Highway.Name             425248 425248      100   \n6 Bridge.Highway.Direction        425248 425248      100   \n7 Road.Ramp                       425248 425248      100   \n8 Bridge.Highway.Segment          425248 425248      100   \n9 BBL                               2302 425248        0.54\n\n\nCode\n# Saving results for visualization\nwrite.csv(missing_housing, \"datasets/missing_values_violations.csv\", row.names = FALSE)\nwrite.csv(missing_311, \"datasets/missing_values_311.csv\", row.names = FALSE)\n\n\n\n\n2.2.2 Missing Data Visualizations\n\n\nCode\n# --------- Visualizations: Missingness bar charts (tidy) ---------\n\n# Load the saved summaries (if needed) or use objects directly\n\nmissing_viol_plot &lt;- missing_housing |&gt; filter(missing_pct &gt; 0)\nmissing_311_plot  &lt;- missing_311 |&gt; filter(missing_pct &gt; 0)\n\n# ========== GRAPH 1: BAR CHART - HOUSING VIOLATIONS ==========\n\np1 &lt;- ggplot(missing_viol_plot, aes(x = reorder(column, missing_pct), y = missing_pct)) +\n  geom_bar(stat = \"identity\", fill = \"steelblue\") +\n  coord_flip() +\n  labs(\n  title = \"Missing Values in Housing Violations Dataset\",\n  subtitle = \"Manhattan, 2022-2025\",\n  x = \"Column Name\",\n  y = \"Percentage Missing (%)\"\n  ) +\n  theme_minimal(base_size = 14) +\n  theme(\n  plot.title = element_text(face = \"bold\", size = 16),\n  axis.text.y = element_text(size = 11)\n  )\n\nprint(p1)\n\n\n\n\n\n\n\n\n\n\n\nCode\n# ========== GRAPH 2: BAR CHART - 311 COMPLAINTS ==========\n\np2 &lt;- ggplot(missing_311_plot, aes(x = reorder(column, missing_pct), y = missing_pct)) +\n  geom_bar(stat = \"identity\", fill = \"coral\") +\n  coord_flip() +\n  labs(\n  title = \"Missing Values in 311 Housing Complaints Dataset\",\n  subtitle = \"Manhattan, 2022-2025\",\n  x = \"Column Name\",\n  y = \"Percentage Missing (%)\"\n  ) +\n  theme_minimal(base_size = 14) +\n  theme(\n  plot.title = element_text(face = \"bold\", size = 16),\n  axis.text.y = element_text(size = 11)\n  )\n\nprint(p2)\n\n\n\n\n\n\n\n\n\n\n\n2.2.3 MISSING DATA SUMMARY TABLES\n\n2.2.3.1 Housing Violations – Missingness Summary Table\n\n\nCode\nmissing_summary_housing &lt;- tibble(\n  Metric = c(\n  \"Total Columns\",\n  \"Columns &gt; 0% Missing\",\n  \"Columns &gt; 50% Missing\",\n  \"Columns == 100% Missing\",\n  \"Columns == 0% Missing\"\n  ),\n  Value = c(\n    nrow(missing_housing),\n    nrow(filter(missing_housing, missing_pct &gt; 0)),\n    nrow(filter(missing_housing, missing_pct &gt; 50)),\n    nrow(filter(missing_housing, missing_pct == 100)),\n    nrow(filter(missing_housing, missing_pct == 0))\n  )\n)\n\nmissing_summary_housing\n\n\n# A tibble: 5 × 2\n  Metric                  Value\n  &lt;chr&gt;                   &lt;int&gt;\n1 Total Columns              41\n2 Columns &gt; 0% Missing       10\n3 Columns &gt; 50% Missing       0\n4 Columns == 100% Missing     0\n5 Columns == 0% Missing      31\n\n\n\n\n2.2.3.2 311 Complaints – Missingness Summary Table\n\n\nCode\nmissing_summary_311 &lt;- tibble(\n  Metric = c(\n  \"Total Columns\",\n  \"Columns &gt; 0% Missing\",\n  \"Columns &gt; 50% Missing\",\n  \"Columns == 100% Missing\",\n  \"Columns == 0% Missing\"\n  ),\n  Value = c(\n    nrow(missing_311),\n    nrow(filter(missing_311, missing_pct &gt; 0)),\n    nrow(filter(missing_311, missing_pct &gt; 50)),\n    nrow(filter(missing_311, missing_pct == 100)),\n    nrow(filter(missing_311, missing_pct == 0))\n  )\n)\n\nmissing_summary_311\n\n\n# A tibble: 5 × 2\n  Metric                  Value\n  &lt;chr&gt;                   &lt;int&gt;\n1 Total Columns              42\n2 Columns &gt; 0% Missing        9\n3 Columns &gt; 50% Missing       8\n4 Columns == 100% Missing     8\n5 Columns == 0% Missing      33\n\n\n\n\n\n2.2.4 MISSING VALUE HEATMAPS\n\n\nCode\n# Simple aggregated missing plot\nplot_missing(housing_raw, percent = TRUE, num_char = 3, max_cols = 10)  \n\n\nScale for y is already present.\nAdding another scale for y, which will replace the existing scale.\nScale for y is already present.\nAdding another scale for y, which will replace the existing scale.\n\n\n\n\n\n\n\n\n\nCode\nplot_missing(sr311_raw, percent = TRUE, num_char = 3, max_cols = 10) \n\n\nScale for y is already present.\nAdding another scale for y, which will replace the existing scale.\nScale for y is already present.\nAdding another scale for y, which will replace the existing scale.\n\n\nWarning: Removed 8 rows containing missing values or values outside the scale range\n(`geom_col()`).\n\n\n\n\n\n\n\n\n\n\n\n2.2.5 Missing Value Analysis\nHousing violations dataset is mostly complete since 31/40 columns contain 0 missing values. The remaining 10 columns have less than 50% missing data which in turn means that even incomplete variables retain significant analytical value. Story and NOVID are the columns with highest missing data (13% and 5.8% respectively) andHence, this dataset is consistent and reliable for majority of fields required for analysis.\n311 service requests dataset has polarized missingness pattern with 33/42 columns fully complete but except 1 (BBL) , the remaining 8 (Due.Date, Vehicle.Type, Taxi.Company.Borough, Taxi.Pick.Up.Location, Bridge.Highway.Name, Bridge.Highway.Direction, Road.Ramp, Bridge.Highway.Segment) are entirely empty. We haven’t used these missing data columns in our analysis. These missing data columns suggest that though most of the complaint data is recorded properly some details (mostly not very improtant) are poorly recorded.\nCommentary: The sharp contrast between both our datasets highlights that the data collection challenges were perhaps diffferent because housing violations data is robust and usable across all dimensions but 311 data contains gaps. The 8 blank columns in the 311 dataset are mostly excluded excluded from our analysis to prevent errors. We have used housing dataset with minimal imputation since it’s properly recorded. Overall, there is no specific pattern in the missing values, the missing values in both the datasets is quite random.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Data</span>"
    ]
  },
  {
    "objectID": "project_code_final.html",
    "href": "project_code_final.html",
    "title": "3  Analysis Results",
    "section": "",
    "text": "3.1 Import Libraries, Dataset Setup and Cleaning",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Analysis Results</span>"
    ]
  },
  {
    "objectID": "project_code_final.html#loading-housing-violations-and-311-complaints-datasets",
    "href": "project_code_final.html#loading-housing-violations-and-311-complaints-datasets",
    "title": "3  NYC Building Violation Analysis",
    "section": "3.2 Loading Housing Violations and 311 Complaints Datasets",
    "text": "3.2 Loading Housing Violations and 311 Complaints Datasets\n\n\nCode\n# ========== HOUSING VIOLATIONS ==========\nhousing_raw &lt;- read.csv(\"/Users/shreyashetty/Documents/Fall 2025 Courses/EDAV/Final_Project/edav_project/datasets/Housing_Violations_2022_onwards.csv\")\n\n# ========== 311 HOUSING COMPLAINTS ==========\nsr311_raw   &lt;- read.csv(\"/Users/shreyashetty/Documents/Fall 2025 Courses/EDAV/Final_Project/edav_project/datasets/311_Housing_Complaints_2022_onwards.csv\")",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>NYC Building Violation Analysis</span>"
    ]
  },
  {
    "objectID": "project_code_final.html#inspecting-data-and-column-names-for-both-the-datasets",
    "href": "project_code_final.html#inspecting-data-and-column-names-for-both-the-datasets",
    "title": "3  NYC Building Violation Analysis",
    "section": "3.3 Inspecting data and column names for both the datasets:",
    "text": "3.3 Inspecting data and column names for both the datasets:\n\n3.3.1 Housing Violations Dataset\n\n\nCode\n# head(housing_raw)\n# colnames(housing_raw)\n\n\n\n\nCode\n# summary(housing_raw)\n\n\n\n\n3.3.2 311 Complaints dataset\n\n\nCode\n# head(sr311_raw)\n# colnames(sr311_raw)\n\n\n\n\nCode\n# summary(sr311_raw)",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>NYC Building Violation Analysis</span>"
    ]
  },
  {
    "objectID": "project_code_final.html#checking-key-distributions",
    "href": "project_code_final.html#checking-key-distributions",
    "title": "3  NYC Building Violation Analysis",
    "section": "3.4 Checking Key distributions",
    "text": "3.4 Checking Key distributions\n\n\nCode\n# ========== KEY DISTRIBUTIONS ==========\n\n# Use tidyverse counting (no data.table .N)\n\nhousing_copy &lt;- housing_raw\nsr311_copy &lt;- sr311_raw\n\n# Housing Violations - Top 10 Current Status (showing top 10 since there are many unique values)\n\nhousing_copy |&gt;\n  filter(!is.na(CurrentStatus)) |&gt;\n    count(CurrentStatus, sort = TRUE) |&gt;\n      slice_head(n = 10) |&gt;\n        print()\n\n\n                              CurrentStatus      n\n1                       VIOLATION DISMISSED 197906\n2                          VIOLATION CLOSED 180829\n3                              NOV SENT OUT 112090\n4  FIRST NO ACCESS TO RE- INSPECT VIOLATION  18629\n5                         NOT COMPLIED WITH  17976\n6                         INFO NOV SENT OUT  12927\n7         NOTICE OF ISSUANCE SENT TO TENANT  11160\n8             VIOLATION WILL BE REINSPECTED  10263\n9                              CIV14 MAILED   7244\n10                     DEFECT LETTER ISSUED   5934\n\n\nCode\n# 311 Complaints - Top 10 Complaint Types (showing top 10)\n\nsr311_copy |&gt;\n  filter(!is.na(Complaint.Type)) |&gt;\n    count(Complaint.Type, sort = TRUE) |&gt;\n      slice_head(n = 10) |&gt;\n        print()\n\n\n                  Complaint.Type      n\n1                 HEAT/HOT WATER 229222\n2                       PLUMBING  50637\n3                  PAINT/PLASTER  44624\n4                     WATER LEAK  30190\n5  General Construction/Plumbing  25207\n6        Maintenance or Facility  20202\n7                       Elevator  16588\n8                       Plumbing   2197\n9                       ELEVATOR   1302\n10          Non-Residential Heat   1094\n\n\nCode\n# 311 Complaints - Status distribution\n\nsr311_copy |&gt;\n  filter(!is.na(Status)) |&gt;\n    count(Status, sort = TRUE) |&gt;\n      print()\n\n\n       Status      n\n1      Closed 419047\n2        Open   5152\n3 In Progress    922\n4    Assigned    124\n5 Unspecified      3\n\n\nCode\n# 311 Complaints - Top Agencies\n\nsr311_copy |&gt;\n  filter(!is.na(Agency)) |&gt;\n    count(Agency, sort = TRUE) |&gt;\n      slice_head(n = 10) |&gt;\n        print()\n\n\n  Agency      n\n1    HPD 358603\n2    DOB  43687\n3    DPR  20202\n4  DOHMH   1579\n5    DOE   1064\n6    DEP     99\n7    DOT     14",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>NYC Building Violation Analysis</span>"
    ]
  },
  {
    "objectID": "project_code_final.html#formatting-dates-and-making-sure-loaded-data-has-only-manhattan-borough-entries",
    "href": "project_code_final.html#formatting-dates-and-making-sure-loaded-data-has-only-manhattan-borough-entries",
    "title": "3  NYC Building Violation Analysis",
    "section": "3.3 Formatting dates and making sure loaded data has only Manhattan Borough entries",
    "text": "3.3 Formatting dates and making sure loaded data has only Manhattan Borough entries\nHere, we created a robust set of parse orders for mixed formats in both our datasets. We created cleaned date columns while keep original columns untouched. Also, we added new columns with month-year (Month name + Year) extracted which will be used for alluvial stacks later on\n\n\nCode\n# VALID DATE ORDERS\n\ndate_orders &lt;- c(\"mdY HMS\", \"mdY HM\", \"mdY\", \"Ymd HMS\", \"Ymd\")\n\nhousing &lt;- housing_raw |&gt;\n  mutate(\n    borough_std = toupper(Borough),\n    # PARSE master versions — keep duplicates untouched\n    inspectiondate_clean = parse_date_time(InspectionDate, orders = date_orders),\n    approveddate_clean   = parse_date_time(ApprovedDate, orders = date_orders),\n    certifieddate_clean  = parse_date_time(CertifiedDate, orders = date_orders),\n    novissued_clean      = parse_date_time(NOVIssuedDate, orders = date_orders),\n    statusdate_clean     = parse_date_time(CurrentStatusDate, orders = date_orders),\n    originalcertifybydate_clean = parse_date_time(OriginalCertifyByDate, orders = date_orders),\n    originalcorrectbydate_clean = parse_date_time(OriginalCorrectByDate, orders = date_orders),\n    newcertifybydate_clean = parse_date_time(NewCertifyByDate, orders = date_orders),\n    newcorrectbydate_cean = parse_date_time(NewCorrectByDate, orders = date_orders),\n  ) |&gt;\n  filter(borough_std == \"MANHATTAN\")\n\nsr311 &lt;- sr311_raw |&gt;\n  mutate(\n    borough_std = toupper(Borough),\n    created_clean = parse_date_time(Created.Date, orders = date_orders),\n    closed_clean  = parse_date_time(Closed.Date, orders = date_orders)\n  ) |&gt;\n  filter(borough_std == \"MANHATTAN\")\n\n\n# adding month-year (Month name + Year) columns used for alluvial stacks\n\nhousing &lt;- housing |&gt;\n  mutate(\n    inspection_month = ifelse(!is.na(inspectiondate_clean),\n                              format(floor_date(inspectiondate_clean, \"month\"), \"%B %Y\"),\n                              NA_character_),\n    approved_month = ifelse(!is.na(approveddate_clean), \n                            format(floor_date(approveddate_clean,\"month\"), \"%B %Y\"),\n                            NA_character_),\n    nov_month = ifelse(!is.na(novissued_clean),\n                       format(floor_date(novissued_clean, \"month\"), \"%B %Y\"),\n                       NA_character_),\n    status_month = ifelse(!is.na(statusdate_clean),\n                          format(floor_date(statusdate_clean, \"month\"), \"%B %Y\"),\n                          NA_character_)\n  )\n\n\nHousing Violations updated rows check:\n\n\nCode\n# Hosuing violations rows\nnrow(housing)\n\n\n[1] 589005\n\n\n\n\nCode\nsr311 &lt;- sr311 |&gt;\n  mutate(\n    created_month = ifelse(!is.na(created_clean),\n                           format(floor_date(created_clean, \"month\"), \"%B %Y\"),\n                           NA_character_),\n    closed_month = ifelse(!is.na(closed_clean),\n                           format(floor_date(closed_clean, \"month\"), \"%B %Y\"),\n                           NA_character_)\n)\n\n\n311 Request udpated rows check:\n\n\nCode\n# 311 requests rows updated\nnrow(sr311)\n\n\n[1] 425248\n\n\nThe date columns have been parsed properly and as we can see the both raw data we downloaded, only had data from the Manhattan borough since before and after filtering the number of rows remain same for both datastes i.e. 589005 rows in Housing Violations dataset and 425248 rows in 311 requests dataset.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>NYC Building Violation Analysis</span>"
    ]
  },
  {
    "objectID": "project_code_final.html#housing-violation-decription-column-data-cleaning",
    "href": "project_code_final.html#housing-violation-decription-column-data-cleaning",
    "title": "3  NYC Building Violation Analysis",
    "section": "3.4 Housing violation decription column data cleaning",
    "text": "3.4 Housing violation decription column data cleaning\n\n\nCode\n## Housing violation description column data cleaning\n\n# First, let's inspect NOVDescription\nhead(housing$NOVDescription, 10)\n\n\n [1] \"(A) § HMC:FILE ANNUAL BEDBUG REPORT IN ACCORDANCE WITH HPD RULE AS DESCRIBED ON THE BACK OF THIS NOTICE OF VIOLATION OR AS DESCRIBED ON HPDâ\\u0080\\u0099S WEBSITE, WWW.NYC.GOV\\\\HPD, SEARCH BED BUGS.\"                                 \n [2] \"§ 27-2005 ADM CODE PAINT METAL IN ACCORDANCE WITH DEPT. REGULATION RADIATOR AT THE SOUTH WALL IN THE KITCHEN LOCATED AT APT 9C, 9th STORY, 3rd APARTMENT FROM EAST AT SOUTH\"                                                           \n [3] \"§ 27-2026 ADM CODE REPAIR THE LEAKY AND/OR DEFECTIVE FAUCETS AT SINK IN THE KITCHENETTE LOCATED AT B-ROOM 3N, 3rd STORY, 1st B-ROOM FROM NORTH AT EAST\"                                                                                \n [4] \"§ 27-2005, 27-2007, 27-2041.1 HMC: REPLACE OR REPAIR THE SELF-CLOSING DOORS THAT IS MISSING OR DEFECTIVE AT BULKHEAD\"                                                                                                                  \n [5] \"§ 27-2026 ADM CODE REPAIR THE LEAKY AND/OR DEFECTIVE FAUCETS AT WASHBASIN IN THE BATHROOM LOCATED AT APT 20B, 2nd STORY, 1st APARTMENT FROM NORTH AT EAST\"                                                                             \n [6] \"§ 27-2046.1 HMC: REPAIR OR REPLACE THE CARBON MONOXIDE DETECTING DEVICE(S). MISSING IN THE ENTIRE APARTMENT LOCATED AT APT 7, 3rd STORY, 1st APARTMENT FROM EAST AT SOUTH\"                                                             \n [7] \"§ 27-2045 ADM CODE REPAIR OR REPLACE THE SMOKE DETECTOR MISSING LOCATED AT APT 2A, 2nd STORY, 1st APARTMENT FROM WEST AT NORTH\"                                                                                                        \n [8] \"§ 27-2046.1 HMC: REPAIR OR REPLACE THE CARBON MONOXIDE DETECTING DEVICE(S). MISSING IN THE ENTIRE APARTMENT LOCATED AT APT 5C, 5th STORY, 1st APARTMENT FROM WEST AT NORTH\"                                                            \n [9] \"§ 27-2045 ADM CODE REPAIR OR REPLACE THE SMOKE DETECTOR MISSING IN THE ENTIRE APARTMENT LOCATED AT APT 5C, 5th STORY, 1st APARTMENT FROM WEST AT NORTH\"                                                                                \n[10] \"§ 27-2005 ADM CODE REPAIR THE BROKEN OR DEFECTIVE PLASTERED SURFACES AND PAINT IN A UNIFORM COLOR EAST WALL APPROX 4SQ FT AND NORTH WALL APPROX 4 SQ FT IN THE BATHROOM LOCATED AT APT 1A, 1st STORY, 2nd APARTMENT FROM SOUTH AT WEST\"\n\n\nCode\n# ========== REFINED CATEGORIZATION ==========\nhousing &lt;- housing |&gt;\n  mutate(\n    ViolationCategory = case_when(\n\n      # 1 — Registration (Class I)\n      Class == \"I\" |\n        str_detect(NOVDescription, regex(\"registration|register\", ignore_case = TRUE)) ~\n        \"REGISTRATION/ADMIN\",\n\n      # 2 — Smoke / CO\n      str_detect(NOVDescription, regex(\"smoke detector|carbon monoxide|co detect\", ignore_case = TRUE)) ~\n        \"SMOKE/CO DETECTOR\",\n\n      # 3 — Heat / Hot Water\n      str_detect(NOVDescription, regex(\"heat|heating|hot water|radiator|boiler|steam|too cold\", ignore_case = TRUE)) ~\n        \"HEAT/HOT WATER\",\n\n      # 4 — Plumbing\n      str_detect(NOVDescription, regex(\"plumb|pipe|faucet|drain|sewer|bathroom|sink|toilet|water supply\", ignore_case = TRUE)) ~\n        \"PLUMBING\",\n\n      # 5 — Water leak\n      str_detect(NOVDescription, regex(\"leak|leaking|leakage|water drip\", ignore_case = TRUE)) ~\n        \"WATER LEAK\",\n\n      # 6 — Paint / Plaster\n      str_detect(NOVDescription, regex(\"paint|plaster|peel|wall|ceiling\", ignore_case = TRUE)) ~\n        \"PAINT/PLASTER\",\n\n      # 7 — Door / Window / Lock\n      str_detect(NOVDescription, regex(\"door|window|lock|self-closing|entrance\", ignore_case = TRUE)) ~\n        \"DOOR/WINDOW/LOCK\",\n\n      # 8 — Pest / Sanitation\n      str_detect(NOVDescription, regex(\"rodent|pest|roach|mice|rat|garbage|infest|sanitation\", ignore_case = TRUE)) ~\n        \"PEST/SANITATION\",\n\n      # 9 — Floor / Ceiling\n      str_detect(NOVDescription, regex(\"floor|tile|carpet|wood floor|ceramic\", ignore_case = TRUE)) ~\n        \"FLOOR/CEILING\",\n\n      # 10 — Elevator\n      str_detect(NOVDescription, regex(\"elevator|lift\", ignore_case = TRUE)) ~\n        \"ELEVATOR\",\n\n      # 11 — Mold\n      str_detect(NOVDescription, regex(\"mold|mildew|moisture\", ignore_case = TRUE)) ~\n        \"MOLD\",\n\n      # 12 — Electrical\n      str_detect(NOVDescription, regex(\"electric|wiring|outlet|light|circuit\", ignore_case = TRUE))  ~ \"ELECTRICAL\",\n\n      # 13 — Gas / Appliances\n      str_detect(NOVDescription, regex(\"gas|appliance|stove\", ignore_case = TRUE)) ~\n        \"GAS/APPLIANCES\",\n\n      # 14 — Ventilation\n      str_detect(NOVDescription, regex(\"ventilat|airflow|exhaust fan\", ignore_case = TRUE)) ~\n        \"VENTILATION\",\n\n      # 15— Fire Safety\n      str_detect(NOVDescription, regex(\"fire|sprinkler|fire escape|extinguish\", ignore_case = TRUE)) ~\n        \"FIRE SAFETY\",\n\n      # 16— Intercom / Bell\n      str_detect(NOVDescription, regex(\"bell|buzzer|intercom\", ignore_case = TRUE)) ~\n        \"BUILDING SYSTEMS\",\n\n      # 17 — Building Management\n      str_detect(NOVDescription, regex(\"janitor|superintendent|building service|super\", ignore_case = TRUE)) ~\n        \"BUILDING MANAGEMENT\",\n\n      # Default\n      TRUE ~ \"OTHER\"\n    )\n  )\n\n# Check distribution of newly created categories\nhousing |&gt;\n  count(ViolationCategory, sort = TRUE) |&gt;\n  print()\n\n\n     ViolationCategory      n\n1        PAINT/PLASTER 127336\n2             PLUMBING  93154\n3     DOOR/WINDOW/LOCK  91860\n4                OTHER  53533\n5      PEST/SANITATION  50753\n6    SMOKE/CO DETECTOR  40227\n7       HEAT/HOT WATER  39990\n8   REGISTRATION/ADMIN  35133\n9           WATER LEAK  23370\n10       FLOOR/CEILING  19633\n11         FIRE SAFETY   7121\n12      GAS/APPLIANCES   4004\n13          ELECTRICAL   1607\n14    BUILDING SYSTEMS    679\n15 BUILDING MANAGEMENT    376\n16                MOLD    118\n17            ELEVATOR     81\n18         VENTILATION     30\n\n\n\n\nCode\n# ========== 311: CATEGORY MAPPING (parallel to housing) ==========\n\n# Compare with 311 Complaint Types\nsr311 |&gt;\n  count(Complaint.Type, sort = TRUE) |&gt;\n  print()\n\n\n                  Complaint.Type      n\n1                 HEAT/HOT WATER 229222\n2                       PLUMBING  50637\n3                  PAINT/PLASTER  44624\n4                     WATER LEAK  30190\n5  General Construction/Plumbing  25207\n6        Maintenance or Facility  20202\n7                       Elevator  16588\n8                       Plumbing   2197\n9                       ELEVATOR   1302\n10          Non-Residential Heat   1094\n11            School Maintenance   1064\n12              OUTSIDE BUILDING    857\n13                    Water Leak    556\n14                Heat/Hot Water    487\n15                 Paint/Plaster    404\n16                          Mold    402\n17  Building Drinking Water Tank     83\n18             Sewer Maintenance     68\n19             Water Maintenance     31\n20            Building Condition     19\n21             Unstable Building     14\n\n\nCode\n# Mapped categories\nsr311 &lt;- sr311 |&gt;\n  mutate(\n    Category = case_when(\n      # Heat / Hot Water\n      str_detect(`Complaint.Type`, regex(\"HEAT|HOT WATER\", ignore_case = TRUE)) ~ \"HEAT/HOT WATER\",\n      \n      # Plumbing\n      str_detect(`Complaint.Type`, regex(\"PLUMBING\", ignore_case = TRUE)) ~ \"PLUMBING\",\n      \n      # Water Leak\n      str_detect(`Complaint.Type`, regex(\"WATER LEAK\", ignore_case = TRUE)) ~ \"WATER LEAK\",\n      \n      # Elevator\n      str_detect(`Complaint.Type`, regex(\"ELEVATOR\", ignore_case = TRUE)) ~ \"ELEVATOR\",\n      \n      # Mold\n      str_detect(`Complaint.Type`, regex(\"MOLD\", ignore_case = TRUE)) ~ \"MOLD\",\n      \n      # PAINT / PLASTER — newly added\n      str_detect(`Complaint.Type`, regex(\"PAINT|PLASTER\", ignore_case = TRUE)) ~ \"PAINT/PLASTER\",\n      \n      # Pest / sanitation based on Complaint.Type AND Descriptor\n      (\n        str_detect(`Complaint.Type`, regex(\"MAINTENANCE|FACILITY\", ignore_case = TRUE)) &\n        str_detect(Descriptor, regex(\"rodent|rodents|mice|rats|mouse|rat|insect|pest\", ignore_case = TRUE))\n      ) ~ \"PEST/SANITATION\",\n      \n      # Fallback\n      TRUE ~ \"OTHER\"\n    )\n  )\n\n# New mapped categories\nsr311 |&gt;\n  count(Category, sort = TRUE) |&gt;\n  print()\n\n\n         Category      n\n1  HEAT/HOT WATER 230803\n2        PLUMBING  78041\n3   PAINT/PLASTER  45028\n4      WATER LEAK  30746\n5        ELEVATOR  17890\n6           OTHER  17784\n7 PEST/SANITATION   4554\n8            MOLD    402\n\n\nHere, manual categorization logic we applied successfully maps unstructured text descriptions (NOVDescriptions) in Housing Violations dataset into unified high-level categories which enables a direct one-to-one comparison between both. We also normalized the categories in 311 Complaints dataset since there were multiple for the same category, ege. there were 2 types “HEAT/HOT WATER” and “Heat/Hot Water” which were merged into 1.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>NYC Building Violation Analysis</span>"
    ]
  },
  {
    "objectID": "project_code_final.html#save-cleaned-csv-copies-for-reproducibility",
    "href": "project_code_final.html#save-cleaned-csv-copies-for-reproducibility",
    "title": "3  NYC Building Violation Analysis",
    "section": "3.5 Save cleaned CSV copies for reproducibility",
    "text": "3.5 Save cleaned CSV copies for reproducibility\n\n\nCode\nwrite.csv(housing, \"datasets/housing_manhattan_3years_clean.csv\", row.names = FALSE)\nwrite.csv(sr311,   \"datasets/sr311_manhattan_3years_clean.csv\", row.names = FALSE)",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>NYC Building Violation Analysis</span>"
    ]
  },
  {
    "objectID": "project_code_final.html#category-comparison-housing-vs-311",
    "href": "project_code_final.html#category-comparison-housing-vs-311",
    "title": "3  Analysis Results",
    "section": "3.2 CATEGORY COMPARISON: Housing vs 311",
    "text": "3.2 CATEGORY COMPARISON: Housing vs 311\n\n\nCode\ncomparison_categories &lt;- c(\n  \"HEAT/HOT WATER\", \"PLUMBING\", \"PAINT/PLASTER\",\n  \"WATER LEAK\", \"ELEVATOR\", \"MOLD\", \"PEST/SANITATION\"\n)\n\n# Violations count\nviol_comparison &lt;- housing |&gt;\n  filter(ViolationCategory %in% comparison_categories) |&gt;\n    group_by(ViolationCategory) |&gt;\n      summarise(Count = n(), .groups = \"drop\") |&gt;\n        mutate(\n          Category = ViolationCategory,\n          Source = \"Housing Violations\"\n        ) |&gt;\n          select(Category, Count, Source)\n\n# 311 count\ncomplaints_comparison &lt;- sr311 |&gt;\n  filter(Category %in% comparison_categories) |&gt;\n    group_by(Category) |&gt;\n      summarise(Count = n(), .groups = \"drop\") |&gt;\n        mutate(Source = \"311 Complaints\")\n\n# Combine both\ncombined &lt;- bind_rows(viol_comparison, complaints_comparison)\n\n# Plot\nggplot(combined, aes(x = reorder(Category, -Count), y = Count, fill = Source)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  geom_text(aes(label = scales::comma(Count)),\n            position = position_dodge(width = 0.9),\n            vjust = -0.5, size = 3) +\n  scale_fill_manual(values = c(\n    \"Housing Violations\" = \"purple\",\n    \"311 Complaints\"     = \"pink\"\n  )) +\n  scale_y_continuous(labels = scales::comma,\n                     expand = expansion(mult = c(0, 0.15))) +\n  labs(\n    title = \"Violations vs 311 Complaints by Category\",\n    subtitle = \"Manhattan (Last 3 yrs) Comparable Categories Only\",\n    x = \"Category\",\n    y = \"Count\",\n    fill = \"Source\"\n  ) +\n  theme_minimal(base_size = 16) +\n  theme(\n    plot.title = element_text(face = \"bold\", size = 17),\n    plot.subtitle = element_text(size = 14),\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    legend.position = \"top\"\n  )\n\n\n\n\n\n\n\n\n\nThere is a substantial disparity in volume for the “HEAT/HOT WATER” category in violations vs complaints, where the number of 311 Service Requests is significantly higher than the count of official Housing violations issued for the same. Hence, we can conclude that while tenant complaints regarding heating are very very frequent, quite a smaller proportion result in confirmed enforcement actions by management. In other categories, the difference is relatively small. In case of Paint/Plaster and Pests, there is much higher number of building violation entries which shows that probably regular building inspections is conducted for those and hence less direct 311 complaints. Out of all top 7 identified categories overlapping in both the datasets, Heat/Hot Water is the highest and Mold is the lowest complaint type.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Analysis Results</span>"
    ]
  },
  {
    "objectID": "project_code_final.html#missing-data-summary",
    "href": "project_code_final.html#missing-data-summary",
    "title": "3  NYC Building Violation Analysis",
    "section": "3.9 Missing Data summary:",
    "text": "3.9 Missing Data summary:\n\n\nCode\n# === HOUSING VIOLATIONS ===\n\n# Calculate missing counts and percentages\nmissing_housing &lt;- housing |&gt;\n  summarise(across(everything(), ~ sum(is.na(.)))) |&gt;\n    pivot_longer(everything(), names_to = \"column\", values_to = \"missing_count\") |&gt;\n      mutate(total = nrow(housing), missing_pct = round(100 * missing_count / total, 2)) |&gt;\n        arrange(desc(missing_pct))\n\n\n# Top housing missing columns (sample)\nprint(head(missing_housing, 20))\n\n\n# A tibble: 20 × 4\n   column                      missing_count  total missing_pct\n   &lt;chr&gt;                               &lt;int&gt;  &lt;int&gt;       &lt;dbl&gt;\n 1 newcertifybydate_clean             585410 589005       99.4 \n 2 newcorrectbydate_cean              585410 589005       99.4 \n 3 certifieddate_clean                360194 589005       61.2 \n 4 Story                               77094 589005       13.1 \n 5 NOVID                               34593 589005        5.87\n 6 novissued_clean                     34593 589005        5.87\n 7 originalcertifybydate_clean         34593 589005        5.87\n 8 originalcorrectbydate_clean         34593 589005        5.87\n 9 nov_month                           34593 589005        5.87\n10 BIN                                   305 589005        0.05\n11 BBL                                   305 589005        0.05\n12 Postcode                              147 589005        0.02\n13 Latitude                               77 589005        0.01\n14 Longitude                              77 589005        0.01\n15 CommunityBoard                         77 589005        0.01\n16 CouncilDistrict                        77 589005        0.01\n17 CensusTract                            77 589005        0.01\n18 ViolationID                             0 589005        0   \n19 BuildingID                              0 589005        0   \n20 RegistrationID                          0 589005        0   \n\n\nCode\n# Columns with missing values more than 0%\nprint(filter(missing_housing, missing_pct &gt; 0))\n\n\n# A tibble: 17 × 4\n   column                      missing_count  total missing_pct\n   &lt;chr&gt;                               &lt;int&gt;  &lt;int&gt;       &lt;dbl&gt;\n 1 newcertifybydate_clean             585410 589005       99.4 \n 2 newcorrectbydate_cean              585410 589005       99.4 \n 3 certifieddate_clean                360194 589005       61.2 \n 4 Story                               77094 589005       13.1 \n 5 NOVID                               34593 589005        5.87\n 6 novissued_clean                     34593 589005        5.87\n 7 originalcertifybydate_clean         34593 589005        5.87\n 8 originalcorrectbydate_clean         34593 589005        5.87\n 9 nov_month                           34593 589005        5.87\n10 BIN                                   305 589005        0.05\n11 BBL                                   305 589005        0.05\n12 Postcode                              147 589005        0.02\n13 Latitude                               77 589005        0.01\n14 Longitude                              77 589005        0.01\n15 CommunityBoard                         77 589005        0.01\n16 CouncilDistrict                        77 589005        0.01\n17 CensusTract                            77 589005        0.01\n\n\nCode\n# Columns with missing values more than 50%\nprint(missing_housing[missing_housing$missing_pct &gt; 50, ])\n\n\n# A tibble: 3 × 4\n  column                 missing_count  total missing_pct\n  &lt;chr&gt;                          &lt;int&gt;  &lt;int&gt;       &lt;dbl&gt;\n1 newcertifybydate_clean        585410 589005        99.4\n2 newcorrectbydate_cean         585410 589005        99.4\n3 certifieddate_clean           360194 589005        61.2\n\n\nCode\n# === 311 COMPLAINTS ===\n\n# Calculate missing counts and percentages\nmissing_311 &lt;- sr311 |&gt;\n  summarise(across(everything(), ~ sum(is.na(.)))) |&gt;\n    pivot_longer(everything(), names_to = \"column\", values_to = \"missing_count\") |&gt;\n      mutate(total = nrow(sr311), missing_pct = round(100 * missing_count / total, 2)) |&gt;\n        arrange(desc(missing_pct))\n\n\n# Top 311 missing columns (sample)\nprint(head(missing_311, 20))\n\n\n# A tibble: 20 × 4\n   column                   missing_count  total missing_pct\n   &lt;chr&gt;                            &lt;int&gt;  &lt;int&gt;       &lt;dbl&gt;\n 1 Due.Date                        425248 425248      100   \n 2 Vehicle.Type                    425248 425248      100   \n 3 Taxi.Company.Borough            425248 425248      100   \n 4 Taxi.Pick.Up.Location           425248 425248      100   \n 5 Bridge.Highway.Name             425248 425248      100   \n 6 Bridge.Highway.Direction        425248 425248      100   \n 7 Road.Ramp                       425248 425248      100   \n 8 Bridge.Highway.Segment          425248 425248      100   \n 9 closed_clean                      5151 425248        1.21\n10 closed_month                      5151 425248        1.21\n11 BBL                               2302 425248        0.54\n12 Unique.Key                           0 425248        0   \n13 Created.Date                         0 425248        0   \n14 Closed.Date                          0 425248        0   \n15 Agency                               0 425248        0   \n16 Agency.Name                          0 425248        0   \n17 Complaint.Type                       0 425248        0   \n18 Descriptor                           0 425248        0   \n19 Location.Type                        0 425248        0   \n20 Incident.Zip                         1 425248        0   \n\n\nCode\n# Columns with &gt;0% missing\nprint(filter(missing_311, missing_pct &gt; 0))\n\n\n# A tibble: 11 × 4\n   column                   missing_count  total missing_pct\n   &lt;chr&gt;                            &lt;int&gt;  &lt;int&gt;       &lt;dbl&gt;\n 1 Due.Date                        425248 425248      100   \n 2 Vehicle.Type                    425248 425248      100   \n 3 Taxi.Company.Borough            425248 425248      100   \n 4 Taxi.Pick.Up.Location           425248 425248      100   \n 5 Bridge.Highway.Name             425248 425248      100   \n 6 Bridge.Highway.Direction        425248 425248      100   \n 7 Road.Ramp                       425248 425248      100   \n 8 Bridge.Highway.Segment          425248 425248      100   \n 9 closed_clean                      5151 425248        1.21\n10 closed_month                      5151 425248        1.21\n11 BBL                               2302 425248        0.54\n\n\nCode\n# Columns with &gt;50% missing\nprint(filter(missing_311, missing_pct &gt; 50))\n\n\n# A tibble: 8 × 4\n  column                   missing_count  total missing_pct\n  &lt;chr&gt;                            &lt;int&gt;  &lt;int&gt;       &lt;dbl&gt;\n1 Due.Date                        425248 425248         100\n2 Vehicle.Type                    425248 425248         100\n3 Taxi.Company.Borough            425248 425248         100\n4 Taxi.Pick.Up.Location           425248 425248         100\n5 Bridge.Highway.Name             425248 425248         100\n6 Bridge.Highway.Direction        425248 425248         100\n7 Road.Ramp                       425248 425248         100\n8 Bridge.Highway.Segment          425248 425248         100\n\n\nCode\n# Saving results for visualization\nwrite.csv(missing_housing, \"datasets/missing_values_violations.csv\", row.names = FALSE)\nwrite.csv(missing_311, \"datasets/missing_values_311.csv\", row.names = FALSE)\n\n\n\n3.9.1 Missing Value Analysis",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>NYC Building Violation Analysis</span>"
    ]
  },
  {
    "objectID": "project_code_final.html#missing-visualizations",
    "href": "project_code_final.html#missing-visualizations",
    "title": "3  NYC Building Violation Analysis",
    "section": "3.10 Missing Visualizations",
    "text": "3.10 Missing Visualizations\n\n\nCode\n# --------- Visualizations: Missingness bar charts (tidy) ---------\n\n# Load the saved summaries (if needed) or use objects directly\n\nmissing_viol_plot &lt;- missing_housing |&gt; filter(missing_pct &gt; 0)\nmissing_311_plot  &lt;- missing_311 |&gt; filter(missing_pct &gt; 0)\n\n# ========== GRAPH 1: BAR CHART - HOUSING VIOLATIONS ==========\n\np1 &lt;- ggplot(missing_viol_plot, aes(x = reorder(column, missing_pct), y = missing_pct)) +\n  geom_bar(stat = \"identity\", fill = \"steelblue\") +\n  coord_flip() +\n  labs(\n  title = \"Missing Values in Housing Violations Dataset\",\n  subtitle = \"Manhattan, 2022-2025\",\n  x = \"Column Name\",\n  y = \"Percentage Missing (%)\"\n  ) +\n  theme_minimal(base_size = 14) +\n  theme(\n  plot.title = element_text(face = \"bold\", size = 16),\n  axis.text.y = element_text(size = 11)\n  )\n\nprint(p1)\n\n\n\n\n\n\n\n\n\nCode\n# ========== GRAPH 2: BAR CHART - 311 COMPLAINTS ==========\n\np2 &lt;- ggplot(missing_311_plot, aes(x = reorder(column, missing_pct), y = missing_pct)) +\n  geom_bar(stat = \"identity\", fill = \"coral\") +\n  coord_flip() +\n  labs(\n  title = \"Missing Values in 311 Housing Complaints Dataset\",\n  subtitle = \"Manhattan, 2022-2025\",\n  x = \"Column Name\",\n  y = \"Percentage Missing (%)\"\n  ) +\n  theme_minimal(base_size = 14) +\n  theme(\n  plot.title = element_text(face = \"bold\", size = 16),\n  axis.text.y = element_text(size = 11)\n  )\n\nprint(p2)",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>NYC Building Violation Analysis</span>"
    ]
  },
  {
    "objectID": "project_code_final.html#missing-data-summary-tables",
    "href": "project_code_final.html#missing-data-summary-tables",
    "title": "3  NYC Building Violation Analysis",
    "section": "3.11 MISSING DATA SUMMARY TABLES",
    "text": "3.11 MISSING DATA SUMMARY TABLES\n\n3.11.1 Housing Violations – Missingness Summary Table\n\n\nCode\nmissing_summary_housing &lt;- tibble(\n  Metric = c(\n  \"Total Columns\",\n  \"Columns &gt; 0% Missing\",\n  \"Columns &gt; 50% Missing\",\n  \"Columns == 100% Missing\",\n  \"Columns == 0% Missing\"\n  ),\n  Value = c(\n    nrow(missing_housing),\n    nrow(filter(missing_housing, missing_pct &gt; 0)),\n    nrow(filter(missing_housing, missing_pct &gt; 50)),\n    nrow(filter(missing_housing, missing_pct == 100)),\n    nrow(filter(missing_housing, missing_pct == 0))\n  )\n)\n\nmissing_summary_housing\n\n\n# A tibble: 5 × 2\n  Metric                  Value\n  &lt;chr&gt;                   &lt;int&gt;\n1 Total Columns              56\n2 Columns &gt; 0% Missing       17\n3 Columns &gt; 50% Missing       3\n4 Columns == 100% Missing     0\n5 Columns == 0% Missing      39\n\n\n\n\n3.11.2 311 Complaints – Missingness Summary Table\n\n\nCode\nmissing_summary_311 &lt;- tibble(\n  Metric = c(\n  \"Total Columns\",\n  \"Columns &gt; 0% Missing\",\n  \"Columns &gt; 50% Missing\",\n  \"Columns == 100% Missing\",\n  \"Columns == 0% Missing\"\n  ),\n  Value = c(\n    nrow(missing_311),\n    nrow(filter(missing_311, missing_pct &gt; 0)),\n    nrow(filter(missing_311, missing_pct &gt; 50)),\n    nrow(filter(missing_311, missing_pct == 100)),\n    nrow(filter(missing_311, missing_pct == 0))\n  )\n)\n\nmissing_summary_311\n\n\n# A tibble: 5 × 2\n  Metric                  Value\n  &lt;chr&gt;                   &lt;int&gt;\n1 Total Columns              48\n2 Columns &gt; 0% Missing       11\n3 Columns &gt; 50% Missing       8\n4 Columns == 100% Missing     8\n5 Columns == 0% Missing      37",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>NYC Building Violation Analysis</span>"
    ]
  },
  {
    "objectID": "project_code_final.html#missing-value-heatmaps",
    "href": "project_code_final.html#missing-value-heatmaps",
    "title": "3  NYC Building Violation Analysis",
    "section": "3.12 MISSING VALUE HEATMAPS",
    "text": "3.12 MISSING VALUE HEATMAPS\n\n\nCode\n# Simple aggregated missing plot\nplot_missing(housing, percent = TRUE, num_char = 3, max_cols = 10)  \n\n\nScale for y is already present.\nAdding another scale for y, which will replace the existing scale.\nScale for y is already present.\nAdding another scale for y, which will replace the existing scale.\n\n\n\n\n\n\n\n\n\nCode\nplot_missing(sr311, percent = TRUE, num_char = 3, max_cols = 10) \n\n\nScale for y is already present.\nAdding another scale for y, which will replace the existing scale.\nScale for y is already present.\nAdding another scale for y, which will replace the existing scale.\n\n\nWarning: Removed 8 rows containing missing values or values outside the scale range\n(`geom_col()`).\n\n\n\n\n\n\n\n\n\n\n\nCode\nlibrary(redav)\n\n# ========== HOUSING VIOLATIONS - FIXED ==========\nplot_missing(housing,\n             percent = TRUE,\n             num_char = 5, max_cols = 10)  # Shorten column names to 5 characters\n\n\nScale for y is already present.\nAdding another scale for y, which will replace the existing scale.\nScale for y is already present.\nAdding another scale for y, which will replace the existing scale.\n\n\n\n\n\n\n\n\n\nCode\n# Alternative: Manually create cleaner version\n# First, let's see how many columns we're dealing with\ncat(\"Number of columns:\", ncol(housing))\n\n\nNumber of columns: 56",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>NYC Building Violation Analysis</span>"
    ]
  },
  {
    "objectID": "project_code_final.html#year-per-quarter-faceted-plots-and-combined-panel-these-come-right-after-the-category-comparison-block",
    "href": "project_code_final.html#year-per-quarter-faceted-plots-and-combined-panel-these-come-right-after-the-category-comparison-block",
    "title": "3  NYC Building Violation Analysis",
    "section": "3.7 3-year per-quarter faceted plots and combined panel (these come right AFTER the category comparison block)",
    "text": "3.7 3-year per-quarter faceted plots and combined panel (these come right AFTER the category comparison block)\n\n\nCode\n# ----- HOUSING: QUARTERLY CATEGORY TRENDS (3-LINE-QTRS) -----\n\nhousing_quarter_lines &lt;- housing |&gt;\n  filter(!is.na(inspectiondate_clean)) |&gt;\n    mutate(\n      year = year(inspectiondate_clean),\n      quarter = paste0(\"Q\", quarter(inspectiondate_clean))\n    ) |&gt;\n      count(year, quarter, ViolationCategory) |&gt;\n        mutate(\n          quarter = factor(quarter, levels = c(\"Q1\",\"Q2\",\"Q3\",\"Q4\"))\n        )\n\nfocus_cats &lt;- c(\n  \"HEAT/HOT WATER\",\n  \"PLUMBING\",\n  \"PAINT/PLASTER\",\n  \"WATER LEAK\",\n  \"ELEVATOR\",\n  \"MOLD\",\n  \"PEST/SANITATION\"\n)\n\nhousing_quarter_lines_focus &lt;- housing_quarter_lines |&gt;\n  dplyr::filter(ViolationCategory %in% focus_cats)\n\nggplot(housing_quarter_lines_focus,\n       aes(x = quarter, y = n, color = factor(year), group = year)) +\n  geom_line(linewidth = 1.2) +\n  geom_point(size = 2.2) +\n  scale_y_continuous(labels = scales::comma) +\n  scale_color_manual(values = c(\"2023\" = \"#E63946\",\n                                \"2024\" = \"#457B9D\",\n                                \"2025\" = \"#2A9D8F\"),\n                     name = \"Year\") +\n  facet_wrap(~ ViolationCategory,\n             scales = \"free_y\",\n             ncol = 2) +      # 3 facets per row\n  theme_minimal(base_size = 14) +\n  theme(\n    plot.title = element_text(face = \"bold\"),\n    axis.text.x = element_text(angle = 0),\n    legend.position = \"top\"\n  ) +\n  labs(\n    title = \"Quarterly Housing Violations by Category\",\n    subtitle = \"Manhattan (2023–2025) • Selected Categories\",\n    x = \"Quarter\",\n    y = \"Number of Violations\"\n  )\n\n\n\n\n\n\n\n\n\nCode\n# ----- 311: QUARTERLY CATEGORY TRENDS (3-LINE-QTRS) -----\n\nsr311_quarter_lines &lt;- sr311 |&gt;\n  filter(!is.na(created_clean)) |&gt;\n  mutate(\n    year    = year(created_clean),\n    quarter = paste0(\"Q\", quarter(created_clean))\n  ) |&gt;\n  count(year, quarter, Category) |&gt;\n  mutate(\n    quarter = factor(quarter, levels = c(\"Q1\",\"Q2\",\"Q3\",\"Q4\"))\n  )\n\nsr311_quarter_lines_focus &lt;- sr311_quarter_lines |&gt;\n  filter(Category %in% focus_cats)\n\nggplot(sr311_quarter_lines_focus,\n       aes(x = quarter, y = n, color = factor(year), group = year)) +\n  geom_line(linewidth = 1.2) +\n  geom_point(size = 2.2) +\n  scale_y_continuous(labels = scales::comma) +\n  scale_color_manual(values = c(\"2023\" = \"#E63946\",\n                                \"2024\" = \"#457B9D\",\n                                \"2025\" = \"#2A9D8F\"),\n                     name = \"Year\") +\n  facet_wrap(~ Category, scales = \"free_y\", ncol = 2) +\n  theme_minimal(base_size = 14) +\n  theme(\n    plot.title  = element_text(face = \"bold\"),\n    axis.text.x = element_text(angle = 0),\n    legend.position = \"top\"\n  ) +\n  labs(\n    title    = \"Quarterly 311 Housing Complaints by Category\",\n    subtitle = \"Manhattan (2023–2025) • Selected Categories\",\n    x = \"Quarter\",\n    y = \"Number of Complaints\"\n  )",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>NYC Building Violation Analysis</span>"
    ]
  },
  {
    "objectID": "project_code_final.html#housing-violation-monthly-transition-alluvial",
    "href": "project_code_final.html#housing-violation-monthly-transition-alluvial",
    "title": "3  NYC Building Violation Analysis",
    "section": "3.8 Housing Violation Monthly Transition Alluvial",
    "text": "3.8 Housing Violation Monthly Transition Alluvial\n\n\nCode\n# ---- Housing Violation Monthly Transition Alluvial ----\n# Uses cleaned date columns created earlier: inspectiondate_clean, novissued_clean, statusdate_clean\n\n\nviol_flow &lt;- housing |&gt;\n  # select the cleaned date cols we created earlier (keep original cols untouched)\n  select(ViolationID, Class, inspectiondate_clean, novissued_clean, statusdate_clean) |&gt;\n  # convert dates to YYYY-MM character format for clearer alluvial axes\n  mutate(\n    insp_m  = ifelse(!is.na(inspectiondate_clean),\n                     format(floor_date(inspectiondate_clean, \"month\"), \"%Y-%m\"),\n                     NA_character_),\n    nov_m   = ifelse(!is.na(novissued_clean),\n                     format(floor_date(novissued_clean, \"month\"), \"%Y-%m\"),\n                     NA_character_),\n    stat_m  = ifelse(!is.na(statusdate_clean),\n                     format(floor_date(statusdate_clean, \"month\"), \"%Y-%m\"),\n                     NA_character_)\n  ) |&gt;\n  # require an inspection + at least one later stage\n  filter(!is.na(insp_m) & ( !is.na(nov_m) | !is.na(stat_m) )) |&gt;\n  group_by(insp_m, nov_m, stat_m, Class) |&gt;\n  summarise(n = n(), .groups = \"drop\")\n\n# Quick check\nprint(head(viol_flow, 6))\n\n\n# A tibble: 6 × 5\n  insp_m  nov_m   stat_m  Class     n\n  &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt; &lt;int&gt;\n1 2022-01 2022-01 2022-01 A       115\n2 2022-01 2022-01 2022-01 B       341\n3 2022-01 2022-01 2022-01 C       225\n4 2022-01 2022-01 2022-02 A         3\n5 2022-01 2022-01 2022-02 B        72\n6 2022-01 2022-01 2022-02 C       331\n\n\nCode\n# plot\nggplot(viol_flow,\n       aes(axis1 = insp_m, axis2 = nov_m, axis3 = stat_m, y = n)) +\n  geom_alluvium(aes(fill = Class), width = 0.25, alpha = 0.85) +\n  geom_stratum(width = 0.25) +\n  geom_text(stat = \"stratum\",\n            aes(label = after_stat(stratum)),\n            size = 2.5) +\n  theme_minimal() +\n  labs(\n    title = \"Housing Violations Flow Across Dates (Monthly): Inspection → NOV → Status\",\n    x = \"Month\",\n    y = \"Count\"\n  ) +\n  theme(\n    axis.text.x = element_text(size = 8, angle = 45, hjust = 1),\n    plot.title = element_text(face = \"bold\", size = 8)\n  )\n\n\nWarning in to_lodes_form(data = data, axes = axis_ind, discern =\nparams$discern): Some strata appear at multiple axes.\nWarning in to_lodes_form(data = data, axes = axis_ind, discern =\nparams$discern): Some strata appear at multiple axes.\nWarning in to_lodes_form(data = data, axes = axis_ind, discern =\nparams$discern): Some strata appear at multiple axes.\n\n\n\n\n\n\n\n\n\n\n3.8.1 Time Series Daily\n\n\nCode\nhousing |&gt;\n  filter(!is.na(inspectiondate_clean)) |&gt;\n  count(inspectiondate_clean) |&gt;\n  ggplot(aes(x = inspectiondate_clean, y = n)) +\n  geom_line(color = \"red\") +\n  labs(title = \"Housing Violations Timeline (daily, Manhattan, 2023-2025)\",\n  x = \"Inspection date\", y = \"Count\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nCode\nsr311 |&gt;\n  filter(!is.na(created_clean)) |&gt;\n  count(created_clean) |&gt;\n  ggplot(aes(x = created_clean, y = n)) +\n  geom_line(color = \"orange\") +\n  labs(title = \"311 Requests Timeline (daily, Manhattan, 2023-2025)\",\n  x = \"Created date\", y = \"Count\") +\n  theme_minimal()",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>NYC Building Violation Analysis</span>"
    ]
  },
  {
    "objectID": "project_code_final.html#monthly-combined-time-series-line",
    "href": "project_code_final.html#monthly-combined-time-series-line",
    "title": "3  NYC Building Violation Analysis",
    "section": "3.10 Monthly combined time series (line)",
    "text": "3.10 Monthly combined time series (line)\n\n\nCode\nhousing_month &lt;- housing |&gt;\n  filter(!is.na(inspectiondate_clean)) |&gt;\n  mutate(month = floor_date(inspectiondate_clean, \"month\")) |&gt;\n  count(month, name = \"HousingCount\")\n\nsr311_month &lt;- sr311 |&gt;\n  filter(!is.na(created_clean)) |&gt;\n  mutate(month = floor_date(created_clean, \"month\")) |&gt;\n  count(month, name = \"ComplaintCount\")\n\nmonthly_combined &lt;- full_join(housing_month, sr311_month, by = \"month\") |&gt;\n  replace_na(list(HousingCount = 0, ComplaintCount = 0))\n\nmonthly_combined |&gt;\n  pivot_longer(cols = c(HousingCount, ComplaintCount), names_to = \"Source\", values_to = \"Count\") |&gt;\n  ggplot(aes(x = month, y = Count, color = Source)) +\n  geom_line(size = 1) +\n  geom_point(size = 1.5) +\n  scale_x_date(date_labels = \"%b %Y\", date_breaks = \"1 month\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +\n  labs(title = \"Monthly: Housing Violations vs 311 Complaints (Manhattan)\",\n  x = \"Month\", y = \"Count\")\n\n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>NYC Building Violation Analysis</span>"
    ]
  },
  {
    "objectID": "project_code_final.html#top-15-311-complaint-types",
    "href": "project_code_final.html#top-15-311-complaint-types",
    "title": "3  NYC Building Violation Analysis",
    "section": "3.10 Top 15 311 Complaint Types",
    "text": "3.10 Top 15 311 Complaint Types\n\n\nCode\nsr311 |&gt;\n  filter(!is.na(Complaint.Type)) |&gt; \n  count(Complaint.Type) |&gt;\n  slice_max(n, n = 15) |&gt;\n  ggplot(aes(x = reorder(Complaint.Type, n), y = n)) +\n  geom_col(fill = \"steelblue\") +\n  coord_flip() +\n  labs(title = \"Top 15 311 Complaints (Manhattan, 3 Years)\", x = \"\", y = \"Count\") +\n  theme_minimal()",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>NYC Building Violation Analysis</span>"
    ]
  },
  {
    "objectID": "project_code_final.html#top-20-streets-by-housing-violations",
    "href": "project_code_final.html#top-20-streets-by-housing-violations",
    "title": "3  NYC Building Violation Analysis",
    "section": "3.11 Top 20 streets by housing violations",
    "text": "3.11 Top 20 streets by housing violations\n\n\nCode\nhousing |&gt;\nfilter(!is.na(StreetName)) |&gt;\ncount(StreetName) |&gt;\nslice_max(n, n = 20) |&gt;\nggplot(aes(x = reorder(StreetName, n), y = n)) +\ngeom_col(fill = \"steelblue\") +\ncoord_flip() +\nlabs(title = \"Top 20 Manhattan Streets by Housing Violations (2023-2025)\",\nx = \"Street\", y = \"Count\") +\ntheme_minimal()",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>NYC Building Violation Analysis</span>"
    ]
  },
  {
    "objectID": "project_code_final.html#top-20-zips-for-311",
    "href": "project_code_final.html#top-20-zips-for-311",
    "title": "3  NYC Building Violation Analysis",
    "section": "3.12 Top 20 ZIPs for 311",
    "text": "3.12 Top 20 ZIPs for 311\n\n\nCode\nsr311 |&gt;\nfilter(!is.na(Incident.Zip)) |&gt;\ncount(Incident.Zip) |&gt;\nslice_max(n, n = 20) |&gt;\nggplot(aes(x = reorder(Incident.Zip, n), y = n)) +\ngeom_col(fill = \"purple\") +\ncoord_flip() +\nlabs(title = \"Top 20 ZIP Codes by 311 Complaints (Manhattan, 2023-2025)\",\nx = \"ZIP\", y = \"Count\") +\ntheme_minimal()",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>NYC Building Violation Analysis</span>"
    ]
  },
  {
    "objectID": "project_code_final.html#housing-alluvial-class---status-3-years",
    "href": "project_code_final.html#housing-alluvial-class---status-3-years",
    "title": "3  NYC Building Violation Analysis",
    "section": "3.13 Housing Alluvial: Class -> Status (3 Years)",
    "text": "3.13 Housing Alluvial: Class -&gt; Status (3 Years)\n\n\nCode\nhousing |&gt;\nfilter(!is.na(Class), !is.na(CurrentStatusID)) |&gt;\ncount(Class, CurrentStatusID) |&gt;\nggplot(aes(axis1 = Class, axis2 = CurrentStatusID, y = n)) +\ngeom_alluvium(aes(fill = Class), width = 0.25) +\ngeom_stratum(width = 0.25) +\ngeom_text(stat = \"stratum\", aes(label = after_stat(stratum)), size = 3) +\ntheme_minimal() +\nlabs(title = \"Housing Violations: Class → Current Status (3 Years)\", y = \"Count\")",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>NYC Building Violation Analysis</span>"
    ]
  },
  {
    "objectID": "project_code_final.html#alluvial-class---nov-type",
    "href": "project_code_final.html#alluvial-class---nov-type",
    "title": "3  NYC Building Violation Analysis",
    "section": "3.14 Alluvial: Class -> NOV Type",
    "text": "3.14 Alluvial: Class -&gt; NOV Type\n\n\nCode\nhousing |&gt;\nfilter(!is.na(Class), !is.na(NovType)) |&gt;\ncount(Class, NovType) |&gt;\nggplot(aes(axis1 = Class, axis2 = NovType, y = n)) +\ngeom_alluvium(aes(fill = Class), width = 0.25) +\ngeom_stratum(width = 0.25) +\ngeom_text(stat = \"stratum\", aes(label = after_stat(stratum)), size = 3) +\ntheme_minimal() +\nlabs(title = \"Housing Violations: Class → NOV Type (3 Years)\", y = \"Count\")",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>NYC Building Violation Analysis</span>"
    ]
  },
  {
    "objectID": "project_code_final.html#spatial-sample-plots",
    "href": "project_code_final.html#spatial-sample-plots",
    "title": "3  Analysis Results",
    "section": "3.7 Spatial sample plots",
    "text": "3.7 Spatial sample plots\n\n3.7.1 Housing Violations\n\n\nCode\nhousing |&gt;\n  filter(!is.na(Longitude) & !is.na(Latitude)) |&gt;\n  slice_sample(n = 5000) |&gt;\n  ggplot(aes(x = Longitude, y = Latitude)) +\n  geom_point(alpha = 0.4, size = 0.6) +\n  theme_minimal() +\n  labs(title = \"Housing Violations Locations (sample 5k)\", x = \"Longitude\", y = \"Latitude\")\n\n\n\n\n\n\n\n\n\n\n\n3.7.2 311 Complaints\n\n\nCode\nsr311 |&gt;\n  filter(!is.na(Longitude) & !is.na(Latitude)) |&gt;\n  slice_sample(n = 5000) |&gt;\n  ggplot(aes(x = Longitude, y = Latitude)) +\n  geom_point(alpha = 0.4, size = 0.6, color = \"orange\") +\n  theme_minimal() +\n  labs(title = \"311 Complaints Locations (sample 5k)\", x = \"Longitude\", y = \"Latitude\")",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Analysis Results</span>"
    ]
  },
  {
    "objectID": "project_code_final.html#top-15-housing-classes",
    "href": "project_code_final.html#top-15-housing-classes",
    "title": "3  NYC Building Violation Analysis",
    "section": "3.14 Top 15 Housing Classes",
    "text": "3.14 Top 15 Housing Classes\n\n\nCode\nhousing |&gt;\n  filter(!is.na(Class)) |&gt;\n  count(Class) |&gt;\n  slice_max(n, n = 15) |&gt;\n  ggplot(aes(x = reorder(Class, n), y = n)) +\n  geom_col(fill = \"darkred\") +\n  coord_flip() +\n  labs(title = \"Top 15 Housing Violation Classes (Manhattan, 2023-2025)\", x = \"Class\", y = \"Count\") +\n  theme_minimal()",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>NYC Building Violation Analysis</span>"
    ]
  },
  {
    "objectID": "project_code_final.html#smoothed-temporal-view-research-question-what-are-the-overall-trends-when-we-smooth-out-monthly-fluctuations",
    "href": "project_code_final.html#smoothed-temporal-view-research-question-what-are-the-overall-trends-when-we-smooth-out-monthly-fluctuations",
    "title": "3  NYC Building Violation Analysis",
    "section": "3.15 Smoothed Temporal View Research Question: What are the overall trends when we smooth out monthly fluctuations?",
    "text": "3.15 Smoothed Temporal View Research Question: What are the overall trends when we smooth out monthly fluctuations?\n\n\nCode\n# Aggregate by quarter for smoother trend\nhousing_2[, Quarter := quarter(InspectionDate)]\nhousing_2[, YearQuarter := paste0(Year, \"-Q\", Quarter)]\n\nviol_by_quarter &lt;- housing_2[, .N, by = .(Year, Quarter, YearQuarter)][order(Year, Quarter)]\n\n# Create quarter labels\nviol_by_quarter[, QuarterLabel := paste0(Year, \"\\nQ\", Quarter)]\n\n# Plot\nggplot(viol_by_quarter, aes(x = factor(YearQuarter, levels = YearQuarter), \n                              y = N, group = 1)) +\n  geom_line(color = \"steelblue\", linewidth = 1.2) +\n  geom_point(color = \"steelblue\", size = 3) +\n  scale_y_continuous(labels = scales::comma) +\n  labs(\n    title = \"Housing Violations by Quarter\",\n    subtitle = \"Manhattan, 2022-2025 (smoothed trend)\",\n    x = \"Quarter\",\n    y = \"Number of Violations\"\n  ) +\n  theme_minimal(base_size = 16) +\n  theme(\n    plot.title = element_text(face = \"bold\"),\n    axis.text.x = element_text(angle = 45, hjust = 1)\n  )",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>NYC Building Violation Analysis</span>"
    ]
  },
  {
    "objectID": "project_code_final.html#what-types-of-violations-are-most-common-research-question-what-are-the-most-common-housing-violations-that-tenants-and-inspectors-encounter",
    "href": "project_code_final.html#what-types-of-violations-are-most-common-research-question-what-are-the-most-common-housing-violations-that-tenants-and-inspectors-encounter",
    "title": "3  NYC Building Violation Analysis",
    "section": "3.15 What Types of Violations Are Most Common? Research Question: What are the most common housing violations that tenants and inspectors encounter?",
    "text": "3.15 What Types of Violations Are Most Common? Research Question: What are the most common housing violations that tenants and inspectors encounter?",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>NYC Building Violation Analysis</span>"
    ]
  },
  {
    "objectID": "project_code_final.html#violation-severity-and-status-research-question-what-types-of-violations-are-most-common-and-how-seriously-are-they-being-addressed",
    "href": "project_code_final.html#violation-severity-and-status-research-question-what-types-of-violations-are-most-common-and-how-seriously-are-they-being-addressed",
    "title": "3  NYC Building Violation Analysis",
    "section": "3.16 Violation Severity and Status Research Question: What types of violations are most common, and how seriously are they being addressed?",
    "text": "3.16 Violation Severity and Status Research Question: What types of violations are most common, and how seriously are they being addressed?\n\n\nCode\n# === GRAPH 3A: Violation Class Distribution ===\n# Class definitions: A=Non-Hazardous, B=Hazardous, C=Immediately Hazardous, I=Failure to Register\n\nclass_data &lt;- housing_2[, .N, by=Class][order(-N)]\n\n# Add descriptive labels\nclass_data[, ClassLabel := fcase(\n  Class == \"A\", \"Class A: Non-Hazardous\",\n  Class == \"B\", \"Class B: Hazardous\",\n  Class == \"C\", \"Class C: Immediately Hazardous\",\n  Class == \"I\", \"Class I: Failure to Register\",\n  default = Class\n)]\n\nggplot(class_data, aes(x = reorder(ClassLabel, N), y = N, fill = Class)) +\n  geom_bar(stat = \"identity\") +\n  geom_text(aes(label = scales::comma(N)), hjust = -0.1, size = 5) +\n  coord_flip() +\n  scale_y_continuous(labels = scales::comma, expand = expansion(mult = c(0, 0.15))) +\n  labs(\n    title = \"Housing Violations by Severity Class\",\n    subtitle = \"Manhattan, 2022-2025\",\n    x = \"Violation Class\",\n    y = \"Number of Violations\",\n    caption = \"Class A: Non-hazardous | Class B: Hazardous | Class C: Immediately Hazardous\"\n  ) +\n  theme_minimal(base_size = 16) +\n  theme(\n    plot.title = element_text(face = \"bold\"),\n    legend.position = \"none\"\n  )\n\n\n\n\n\n\n\n\n\nCode\n# === GRAPH 3B: Rent-Impairing Violations ===\n\nrent_data &lt;- housing_2[, .N, by=RentImpairing]\nrent_data[, Label := ifelse(RentImpairing == \"Y\", \n                             \"Rent-Impairing\\n(affects habitability)\", \n                             \"Non-Rent-Impairing\")]\n\nggplot(rent_data, aes(x = Label, y = N, fill = RentImpairing)) +\n  geom_bar(stat = \"identity\") +\n  geom_text(aes(label = paste0(scales::comma(N), \"\\n(\", \n                                round(N/sum(N)*100, 1), \"%)\")), \n            vjust = -0.5, size = 5) +\n  scale_fill_manual(values = c(\"N\" = \"steelblue\", \"Y\" = \"darkred\")) +\n  scale_y_continuous(labels = scales::comma, expand = expansion(mult = c(0, 0.1))) +\n  labs(\n    title = \"Rent-Impairing vs Non-Rent-Impairing Violations\",\n    subtitle = \"Manhattan, 2022-2025\",\n    x = \"\",\n    y = \"Number of Violations\"\n  ) +\n  theme_minimal(base_size = 16) +\n  theme(\n    plot.title = element_text(face = \"bold\"),\n    legend.position = \"none\"\n  )",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>NYC Building Violation Analysis</span>"
    ]
  },
  {
    "objectID": "project_code_final.html#save-cleaned-rds-as-backups",
    "href": "project_code_final.html#save-cleaned-rds-as-backups",
    "title": "3  Analysis Results",
    "section": "3.11 Save cleaned RDS as backups",
    "text": "3.11 Save cleaned RDS as backups\n\n\nCode\nsaveRDS(housing, file = \"housing_manhattan_3years_clean.rds\")\nsaveRDS(sr311,   file = \"sr311_manhattan_3years_clean.rds\")",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Analysis Results</span>"
    ]
  },
  {
    "objectID": "data.html#dataset-1-description",
    "href": "data.html#dataset-1-description",
    "title": "2  Data",
    "section": "",
    "text": "2.1.1 Dataset 2 Description\nLink: 311 Service Requests from 2010 to Present\nThe data is provided by 311, and the dataset owner is NYC OpenData. It is updated daily. It currently has 41.5M rows and 41 columns. The format of the data is CSV in tabular format. It can be downloaded as CSV directly or using the API. Each row is a 311 Service Request. Currently, the dataset is displaying incorrect values in the “Agency Name” column, and we are supposed to use the “Agency” column in the meantime while the issue is resolved. The row identifier is Unique Key, and some of the other columns include Agency (Acronym of responding City Government Agency), Agency name (full name of responding City Government Agency), Complaint Type, Created Date (Date SR was created), Closed Date (Date SR was closed), city, latitude (Geo based Lat of the incident location), longitude (Geo based Long of the incident location), etc. The dataset contains records of non-emergency service requests submitted by residents via phone, web, or mobile app. These requests include a wide range of issues like noise complaints, housing violations, sanitation problems, and public safety concerns. The data is collected by the city’s 311 system.\nNote: One common issue in the dataset is the presence of missing or inconsistent values related to location fields and other columns.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Data</span>"
    ]
  },
  {
    "objectID": "data.html#dataset-2-description",
    "href": "data.html#dataset-2-description",
    "title": "2  Data",
    "section": "2.2 Dataset 2 Description",
    "text": "2.2 Dataset 2 Description\nLink: 311 Service Requests from 2010 to Present\nThe data is provided by 311, and the dataset owner is NYC OpenData. It is updated daily. It currently has 41.5M rows and 41 columns. The format of the data is CSV in tabular format. It can be downloaded as CSV directly or using the API. Each row is a 311 Service Request. Currently, the dataset is displaying incorrect values in the “Agency Name” column, and we are supposed to use the “Agency” column in the meantime while the issue is resolved. The row identifier is Unique Key, and some of the other columns include Agency (Acronym of responding City Government Agency), Agency name (full name of responding City Government Agency), Complaint Type, Created Date (Date SR was created), Closed Date (Date SR was closed), city, latitude (Geo based Lat of the incident location), longitude (Geo based Long of the incident location), etc. The dataset contains records of non-emergency service requests submitted by residents via phone, web, or mobile app. These requests include a wide range of issues like noise complaints, housing violations, sanitation problems, and public safety concerns. The data is collected by the city’s 311 system.\nNote: One common issue in the dataset is the presence of missing or inconsistent values related to location fields and other columns.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Data</span>"
    ]
  },
  {
    "objectID": "data.html#key-distributions-in-dataset",
    "href": "data.html#key-distributions-in-dataset",
    "title": "2  Data",
    "section": "2.3 Key distributions in Dataset",
    "text": "2.3 Key distributions in Dataset\n\n\nCode\n# Libraries\nlibrary(dplyr)\n\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\n\nCode\nlibrary(lubridate)\n\n\n\nAttaching package: 'lubridate'\n\n\nThe following objects are masked from 'package:base':\n\n    date, intersect, setdiff, union\n\n\nCode\nlibrary(janitor)\n\n\n\nAttaching package: 'janitor'\n\n\nThe following objects are masked from 'package:stats':\n\n    chisq.test, fisher.test\n\n\nCode\nlibrary(ggplot2)\nlibrary(ggalluvial)\nlibrary(tidyr)\nlibrary(scales)\nlibrary(data.table)\n\n\n\nAttaching package: 'data.table'\n\n\nThe following objects are masked from 'package:lubridate':\n\n    hour, isoweek, mday, minute, month, quarter, second, wday, week,\n    yday, year\n\n\nThe following objects are masked from 'package:dplyr':\n\n    between, first, last\n\n\nCode\nlibrary(readr)\n\n\n\nAttaching package: 'readr'\n\n\nThe following object is masked from 'package:scales':\n\n    col_factor\n\n\nCode\nlibrary(tidyverse)\n\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ forcats 1.0.1     ✔ stringr 1.6.0\n✔ purrr   1.1.0     ✔ tibble  3.3.0\n\n\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ data.table::between() masks dplyr::between()\n✖ readr::col_factor()   masks scales::col_factor()\n✖ purrr::discard()      masks scales::discard()\n✖ dplyr::filter()       masks stats::filter()\n✖ data.table::first()   masks dplyr::first()\n✖ data.table::hour()    masks lubridate::hour()\n✖ data.table::isoweek() masks lubridate::isoweek()\n✖ dplyr::lag()          masks stats::lag()\n✖ data.table::last()    masks dplyr::last()\n✖ data.table::mday()    masks lubridate::mday()\n✖ data.table::minute()  masks lubridate::minute()\n✖ data.table::month()   masks lubridate::month()\n✖ data.table::quarter() masks lubridate::quarter()\n✖ data.table::second()  masks lubridate::second()\n✖ purrr::transpose()    masks data.table::transpose()\n✖ data.table::wday()    masks lubridate::wday()\n✖ data.table::week()    masks lubridate::week()\n✖ data.table::yday()    masks lubridate::yday()\n✖ data.table::year()    masks lubridate::year()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\n\nCode\nlibrary(forcats)\nlibrary(stringr)\nlibrary(redav)\n# ========== HOUSING VIOLATIONS ==========\nhousing_raw &lt;- read.csv(\"/Users/shreyashetty/Documents/Fall 2025 Courses/EDAV/Final_Project/edav_project/datasets/Housing_Violations_2022_onwards.csv\")\n\n# ========== 311 HOUSING COMPLAINTS ==========\nsr311_raw   &lt;- read.csv(\"/Users/shreyashetty/Documents/Fall 2025 Courses/EDAV/Final_Project/edav_project/datasets/311_Housing_Complaints_2022_onwards.csv\")\n\n\n# ========== KEY DISTRIBUTIONS ==========\n\n# Use tidyverse counting (no data.table .N)\n\nhousing_copy &lt;- housing_raw\nsr311_copy &lt;- sr311_raw\n\n# Housing Violations - Top 10 Current Status (showing top 10 since there are many unique values)\n\nhousing_copy |&gt;\n  filter(!is.na(CurrentStatus)) |&gt;\n    count(CurrentStatus, sort = TRUE) |&gt;\n      slice_head(n = 10) |&gt;\n        print()\n\n\n                              CurrentStatus      n\n1                       VIOLATION DISMISSED 197906\n2                          VIOLATION CLOSED 180829\n3                              NOV SENT OUT 112090\n4  FIRST NO ACCESS TO RE- INSPECT VIOLATION  18629\n5                         NOT COMPLIED WITH  17976\n6                         INFO NOV SENT OUT  12927\n7         NOTICE OF ISSUANCE SENT TO TENANT  11160\n8             VIOLATION WILL BE REINSPECTED  10263\n9                              CIV14 MAILED   7244\n10                     DEFECT LETTER ISSUED   5934\n\n\nCode\n# 311 Complaints - Top 10 Complaint Types (showing top 10)\n\nsr311_copy |&gt;\n  filter(!is.na(Complaint.Type)) |&gt;\n    count(Complaint.Type, sort = TRUE) |&gt;\n      slice_head(n = 10) |&gt;\n        print()\n\n\n                  Complaint.Type      n\n1                 HEAT/HOT WATER 229222\n2                       PLUMBING  50637\n3                  PAINT/PLASTER  44624\n4                     WATER LEAK  30190\n5  General Construction/Plumbing  25207\n6        Maintenance or Facility  20202\n7                       Elevator  16588\n8                       Plumbing   2197\n9                       ELEVATOR   1302\n10          Non-Residential Heat   1094\n\n\nCode\n# 311 Complaints - Status distribution\n\nsr311_copy |&gt;\n  filter(!is.na(Status)) |&gt;\n    count(Status, sort = TRUE) |&gt;\n      print()\n\n\n       Status      n\n1      Closed 419047\n2        Open   5152\n3 In Progress    922\n4    Assigned    124\n5 Unspecified      3\n\n\nCode\n# 311 Complaints - Top Agencies\n\nsr311_copy |&gt;\n  filter(!is.na(Agency)) |&gt;\n    count(Agency, sort = TRUE) |&gt;\n      slice_head(n = 10) |&gt;\n        print()\n\n\n  Agency      n\n1    HPD 358603\n2    DOB  43687\n3    DPR  20202\n4  DOHMH   1579\n5    DOE   1064\n6    DEP     99\n7    DOT     14",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Data</span>"
    ]
  },
  {
    "objectID": "project_code_final.html#year-per-quarter-faceted-plots",
    "href": "project_code_final.html#year-per-quarter-faceted-plots",
    "title": "3  NYC Building Violation Analysis",
    "section": "3.7 3-year per-quarter faceted plots",
    "text": "3.7 3-year per-quarter faceted plots\n\n\nCode\n# ----- HOUSING: QUARTERLY CATEGORY TRENDS (3-LINE-QTRS) -----\n\nhousing_quarter_lines &lt;- housing |&gt;\n  filter(!is.na(inspectiondate_clean)) |&gt;\n    mutate(\n      year = year(inspectiondate_clean),\n      quarter = paste0(\"Q\", quarter(inspectiondate_clean))\n    ) |&gt;\n      count(year, quarter, ViolationCategory) |&gt;\n        mutate(\n          quarter = factor(quarter, levels = c(\"Q1\",\"Q2\",\"Q3\",\"Q4\"))\n        )\n\nfocus_cats &lt;- c(\n  \"HEAT/HOT WATER\",\n  \"PLUMBING\",\n  \"PAINT/PLASTER\",\n  \"WATER LEAK\",\n  \"ELEVATOR\",\n  \"MOLD\",\n  \"PEST/SANITATION\"\n)\n\nhousing_quarter_lines_focus &lt;- housing_quarter_lines |&gt;\n  dplyr::filter(ViolationCategory %in% focus_cats)\n\nggplot(housing_quarter_lines_focus,\n       aes(x = quarter, y = n, color = factor(year), group = year)) +\n  geom_line(linewidth = 1.2) +\n  geom_point(size = 2.2) +\n  scale_y_continuous(labels = scales::comma) +\n  scale_color_manual(values = c(\"2023\" = \"#E63946\",\n                                \"2024\" = \"#457B9D\",\n                                \"2025\" = \"#2A9D8F\"),\n                     name = \"Year\") +\n  facet_wrap(~ ViolationCategory,\n             scales = \"free_y\",\n             ncol = 2) +    \n  theme_minimal(base_size = 14) +\n  theme(\n    plot.title = element_text(face = \"bold\", size = 17),\n    axis.text.x = element_text(angle = 0),\n    legend.position = \"top\"\n  ) +\n  labs(\n    title = \"Quarterly Housing Violations by Category\",\n    subtitle = \"Manhattan (2022–25) • Selected Categories\",\n    x = \"Quarter\",\n    y = \"Number of Violations\"\n  )\n\n\n\n\n\n\n\n\n\nCode\n# ----- 311: QUARTERLY CATEGORY TRENDS (3-LINE-QTRS) -----\n\nsr311_quarter_lines &lt;- sr311 |&gt;\n  filter(!is.na(created_clean)) |&gt;\n  mutate(\n    year    = year(created_clean),\n    quarter = paste0(\"Q\", quarter(created_clean))\n  ) |&gt;\n  count(year, quarter, Category) |&gt;\n  mutate(\n    quarter = factor(quarter, levels = c(\"Q1\",\"Q2\",\"Q3\",\"Q4\"))\n  )\n\nsr311_quarter_lines_focus &lt;- sr311_quarter_lines |&gt;\n  filter(Category %in% focus_cats)\n\nggplot(sr311_quarter_lines_focus,\n       aes(x = quarter, y = n, color = factor(year), group = year)) +\n  geom_line(linewidth = 1.2) +\n  geom_point(size = 2.2) +\n  scale_y_continuous(labels = scales::comma) +\n  scale_color_manual(values = c(\"2023\" = \"#E63946\",\n                                \"2024\" = \"#457B9D\",\n                                \"2025\" = \"#2A9D8F\"),\n                     name = \"Year\") +\n  facet_wrap(~ Category, scales = \"free_y\", ncol = 2) +\n  theme_minimal(base_size = 14) +\n  theme(\n    plot.title  = element_text(face = \"bold\", size = 17),\n    axis.text.x = element_text(angle = 0),\n    legend.position = \"top\"\n  ) +\n  labs(\n    title    = \"Quarterly 311 Complaints by Category\",\n    subtitle = \"Manhattan (2022-25) • Selected Categories\",\n    x = \"Quarter\",\n    y = \"Number of Complaints\"\n  )\n\n\n\n\n\n\n\n\n\nAcross quarters, HEAT/HOT WATER 311 complaints and housing violations both show a clear seasonal pattern. They spike in Q1, drop sharply in Q2 and Q3 for all 3 years, and rise again Q4 matching winter heating needs. For PLUMBING, PAINT/PLASTER, PEST/SANITATION, WATER LEAK, ELEVATOR, and MOLD, housing violations counts change over the quarters (most show a local peak around Q3), but patterns are less sharp and not perfectly identical so they don’t show a single clear seasonal shape like HEAT/HOT WATER does. Pest and sanitation 311 complaints peak in Q3 in all 3 years, which suggests these problems are most common in late summer, which is also consistent with warmer weather since heat and humidity make it easier for rodents, roaches, and insects to spread, and garbage issues can get worse when it’s so hot. But it’s not as strong or as perfectly consistent across all years. For the other categories for 311 complaints, the quarter‑to‑quarter changes within each panel are relatively small and do not follow a clear, repeated seasonal shape across years.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>NYC Building Violation Analysis</span>"
    ]
  },
  {
    "objectID": "project_code_final.html#housing-violation-monthly-transition-alluvial-for-2024",
    "href": "project_code_final.html#housing-violation-monthly-transition-alluvial-for-2024",
    "title": "3  NYC Building Violation Analysis",
    "section": "3.8 Housing Violation Monthly Transition Alluvial for 2024",
    "text": "3.8 Housing Violation Monthly Transition Alluvial for 2024\n\n\nCode\n# ---- Housing Violation 2024 Monthly Transition Alluvial ----\n\nset.seed(123)\nmonth_levels &lt;- c(\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\n                  \"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\")\n\nviol_flow_2024 &lt;- housing |&gt;\n  select(ViolationID, Class,\n         inspectiondate_clean, novissued_clean, statusdate_clean) |&gt;\n  mutate(\n    insp_m = floor_date(inspectiondate_clean, \"month\"),\n    nov_m  = floor_date(novissued_clean,       \"month\"),\n    stat_m = floor_date(statusdate_clean,      \"month\")\n  ) |&gt;\n  filter(!is.na(insp_m),\n         year(insp_m) == 2024,\n         (!is.na(nov_m) | !is.na(stat_m))) |&gt;\n  slice_sample(n = 15000) |&gt;\n  mutate(\n    insp_m_lab = factor(format(insp_m, \"%b\"),  levels = month_levels),\n    nov_m_lab  = factor(format(nov_m,  \"%b\"),  levels = month_levels),\n    stat_m_lab = factor(format(stat_m, \"%b\"),  levels = month_levels)\n  ) |&gt;\n  group_by(insp_m_lab, nov_m_lab, stat_m_lab, Class) |&gt;\n  summarise(n = n(), .groups = \"drop\")\n\n\n# plot\nggplot(viol_flow_2024,\n       aes(axis1 = insp_m_lab, axis2 = nov_m_lab, axis3 = stat_m_lab, y = n)) +\n  geom_alluvium(aes(fill = Class),\n                width = 0.3, alpha = 1) +   # softer, smoother ribbons\n  geom_stratum(aes(fill = Class),\n               width = 0.3, alpha = 0) +\n  geom_text(stat = \"stratum\",\n            aes(label = after_stat(stratum)),\n            size = 3, color = \"black\") +\n  scale_y_continuous(labels = scales::comma) +\n  labs(\n    title = \"Housing Violations Flow in 2024: Inspection → NOV → Status (Sample)\",\n    x = \"Month in 2024\",\n    y = \"Number of violations\"\n  ) +\n  theme_minimal(base_size = 12) +\n  theme(\n    plot.title   = element_text(face = \"bold\", size = 12),\n    legend.title = element_text(face = \"bold\")\n  )\n\n\nWarning in to_lodes_form(data = data, axes = axis_ind, discern =\nparams$discern): Some strata appear at multiple axes.\nWarning in to_lodes_form(data = data, axes = axis_ind, discern =\nparams$discern): Some strata appear at multiple axes.\nWarning in to_lodes_form(data = data, axes = axis_ind, discern =\nparams$discern): Some strata appear at multiple axes.\n\n\n\n\n\n\n\n\n\n\n3.8.1 Time Series Daily\n\n\nCode\nhousing |&gt;\n  filter(!is.na(inspectiondate_clean)) |&gt;\n  count(inspectiondate_clean) |&gt;\n  ggplot(aes(x = inspectiondate_clean, y = n)) +\n  geom_line(color = \"red\") +\n  labs(title = \"Housing Violations Timeline (daily, Manhattan, 2023-2025)\",\n  x = \"Inspection date\", y = \"Count\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nCode\nsr311 |&gt;\n  filter(!is.na(created_clean)) |&gt;\n  count(created_clean) |&gt;\n  ggplot(aes(x = created_clean, y = n)) +\n  geom_line(color = \"orange\") +\n  labs(title = \"311 Requests Timeline (daily, Manhattan, 2023-2025)\",\n  x = \"Created date\", y = \"Count\") +\n  theme_minimal()",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>NYC Building Violation Analysis</span>"
    ]
  },
  {
    "objectID": "project_code_final.html#housing-violation-monthly-transition-alluvial-for-2024-for-a-small-sample-size",
    "href": "project_code_final.html#housing-violation-monthly-transition-alluvial-for-2024-for-a-small-sample-size",
    "title": "3  NYC Building Violation Analysis",
    "section": "3.8 Housing Violation Monthly Transition Alluvial for 2024 (for a small sample size)",
    "text": "3.8 Housing Violation Monthly Transition Alluvial for 2024 (for a small sample size)\n\n\nCode\n# ---- Housing Violation 2024 Monthly Transition Alluvial ----\n\nset.seed(200)\nmonth_levels &lt;- c(\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\n                  \"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\")\n\nviol_flow_2024 &lt;- housing |&gt;\n  select(ViolationID, Class,\n         inspectiondate_clean, novissued_clean, statusdate_clean) |&gt;\n  mutate(\n    insp_m = floor_date(inspectiondate_clean, \"month\"),\n    nov_m  = floor_date(novissued_clean,       \"month\"),\n    stat_m = floor_date(statusdate_clean,      \"month\")\n  ) |&gt;\n  filter(!is.na(insp_m),\n         year(insp_m) == 2024,\n         (!is.na(nov_m) | !is.na(stat_m))) |&gt;\n  slice_sample(n = 200) |&gt;\n  mutate(\n    insp_m_lab = factor(format(insp_m, \"%b\"),  levels = month_levels),\n    nov_m_lab  = factor(format(nov_m,  \"%b\"),  levels = month_levels),\n    stat_m_lab = factor(format(stat_m, \"%b\"),  levels = month_levels)\n  ) |&gt;\n  group_by(insp_m_lab, nov_m_lab, stat_m_lab, Class) |&gt;\n  summarise(n = n(), .groups = \"drop\")\n\n\n# plot\nggplot(viol_flow_2024,\n       aes(axis1 = insp_m_lab, axis2 = nov_m_lab, axis3 = stat_m_lab, y = n)) +\n  geom_alluvium(aes(fill = Class),\n                width = 0.3, alpha = 0.9) +   # softer, smoother ribbons\n  geom_stratum(aes(fill = Class),\n               width = 0.3, alpha = 0.2) +\n  geom_text(stat = \"stratum\",\n            aes(label = after_stat(stratum)),\n            size = 3, color = \"black\") +\n  scale_fill_brewer(type=qual, palette = \"Set2\") +\n  scale_y_continuous(labels = scales::comma) +\n  labs(\n    title = \"2024 Housing Violations Flow: Inspection → NOV → Status (Sample)\",\n    x = \"Stage (Month in 2024)\",\n    y = \"Number of violations\"\n  ) +\n  theme_minimal(base_size = 12) +\n  theme(\n    plot.title   = element_text(face = \"bold\", size = 11),\n    legend.title = element_text(face = \"bold\")\n  )\n\n\n\n\n\n\n\n\n\nWe can see how 2024 housing violations (we have taken a small sample slice of 200 here to visualize better) move from inspection month to NOV (notivr of violation) month to when current status takes effect, with ribbon colors showing violation Class (A least serious, C most serious, I immediately hazardous). Mostly, flows stay within nearby months across 3 stages showing many violations progress through the process within the same part of the year. Thicker orange and blue ribbons show that Class B and C violations make up most of the pipeline, while Class A is thinner and Class I appears as a smaller set of immediately hazardous cases. There are also some blank bands in NOV step which occur when inspection and status dates are recorded but NOVIssuedDate or Class code is missing, so those months or classes appear as NA.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>NYC Building Violation Analysis</span>"
    ]
  },
  {
    "objectID": "project_code_final.html#time-series-daily",
    "href": "project_code_final.html#time-series-daily",
    "title": "3  NYC Building Violation Analysis",
    "section": "3.9 Time Series Daily",
    "text": "3.9 Time Series Daily\n\n\nCode\nhousing |&gt;\n  filter(!is.na(inspectiondate_clean)) |&gt;\n  count(inspectiondate_clean) |&gt;\n  ggplot(aes(x = inspectiondate_clean, y = n)) +\n  geom_line(color = \"red\") +\n  labs(title = \"Housing Violations Timeline (daily, Manhattan, 2022-2025)\",\n  x = \"Inspection date\", y = \"Count\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nCode\nsr311 |&gt;\n  filter(!is.na(created_clean)) |&gt;\n  count(created_clean) |&gt;\n  ggplot(aes(x = created_clean, y = n)) +\n  geom_line(color = \"orange\") +\n  labs(title = \"311 Requests Timeline (daily, Manhattan, 2022-2025)\",\n  x = \"Created date\", y = \"Count\") +\n  theme_minimal()",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>NYC Building Violation Analysis</span>"
    ]
  },
  {
    "objectID": "project_code_final.html#time-series",
    "href": "project_code_final.html#time-series",
    "title": "3  Analysis Results",
    "section": "3.6 Time Series",
    "text": "3.6 Time Series\n\n3.6.1 Housing Daily\n\n\nCode\nhousing |&gt;\n  filter(!is.na(inspectiondate_clean)) |&gt;\n  count(inspectiondate_clean) |&gt;\n  ggplot(aes(x = inspectiondate_clean, y = n)) +\n  geom_line(color = \"purple\") +\n  labs(title = \"Housing Violations Timeline (daily, Manhattan, 2022-2025)\",\n  x = \"Inspection date\", y = \"Count\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nThe spikes here kind of look like a pattern, but the size and shape suggest they are just random glitches and not exactly a real trend. On normal days between 2022-2025, it is mostly noisy and a flat band around a few hundred inspections but on very few days it jumps over 5,000. This is extremely high & not very realistic just 1 day and does not spread over nearby days so it’s not a trend but these spikes are outliers.\n\n\n3.6.2 311 Daily\n\n\nCode\nsr311 |&gt;\n  filter(!is.na(created_clean)) |&gt;\n  count(created_clean) |&gt;\n  ggplot(aes(x = created_clean, y = n)) +\n  geom_line(color = \"pink\") +\n  labs(title = \"311 Requests Timeline (daily, Manhattan, 2022-2025)\",\n  x = \"Created date\", y = \"Count\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nIt is almost a solid pink block with very tiny variation in consecutive days and that’s why it’s very hard to see any clear pattern. Hence, this plot does no give us much information. TO further deep dive into finding a trend in the time series, we plotted combined monthly series for both the dataset.\n\n\n3.6.3 Monthly combined of housing and 311\n\n\nCode\nhousing_month &lt;- housing |&gt;\n  filter(!is.na(inspectiondate_clean)) |&gt;\n  mutate(month = floor_date(inspectiondate_clean, \"month\")) |&gt;\n  count(month, name = \"HousingViolationCount\")\n\nsr311_month &lt;- sr311 |&gt;\n  filter(!is.na(created_clean)) |&gt;\n  mutate(month = floor_date(created_clean, \"month\")) |&gt;\n  count(month, name = \"311ComplaintCount\")\n\nmonthly_combined &lt;- full_join(housing_month, sr311_month, by = \"month\") |&gt;\n  replace_na(list(HousingCount = 0, ComplaintCount = 0))\n\nmonthly_combined |&gt;\n  pivot_longer(cols = c(\"HousingViolationCount\", \"311ComplaintCount\"), names_to = \"Source\", values_to = \"Count\") |&gt;\n  ggplot(aes(x = month, y = Count, color = Source)) +\n  geom_line(linewidth = 1) +\n  geom_point(size = 1.5) +\n  scale_color_manual(values = c(\"311ComplaintCount\" = \"pink\", \"HousingViolationCount\" = \"purple\"))+\n  scale_x_date(date_labels = \"%b %Y\", date_breaks = \"1 month\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 90, hjust = , size = 5)) +\n  labs(title = \"Monthly: Housing Violations vs 311 Complaints (Manhattan)\",\n  x = \"Month\", y = \"Count\")\n\n\n\n\n\n\n\n\n\nHere, both 311 complaints and housing violations in Manhattan during 2022-2025 have a fairly strong seasonal pattern, but there are also some exceptions. In most years the red complaint line is highest in late fall & winter, & lowest in late spring & summer which basically means people call 311 line more about housing problems during colder months when heat and building conditions matter more. Now blue violations line also have major winter peaks overall but it includes few extra spikes in other months (like June & August 2025), so its pattern is winter‑dominated but not specific to winter‑only. Also, some of those spikes might be anomalies and outlier inspections instead of a reasonable trend.\n\n\n3.6.4 Time series Variation by Month and Year\n\n\nCode\nset.seed(2025)\n\n# Load data\nhousing_2 &lt;- as.data.table(housing)\n\n# Convert date and extract time components\nhousing_2[, InspectionDate := as.Date(InspectionDate)]\nhousing_2[, YearMonth := format(InspectionDate, \"%Y-%m\")]\nhousing_2[, Month := month(InspectionDate)]\nhousing_2[, Year := year(InspectionDate)]\n\n# Count violations by month and year\nviol_by_month &lt;- housing_2[, .N, by = .(Year, Month)][order(Year, Month)]\n\n# Create the plot\nggplot(viol_by_month, aes(x = Month, y = N, color = factor(Year), group = Year)) +\n  geom_line(linewidth = 1.2) +\n  geom_point(size = 2.5) +\n  scale_x_continuous(breaks = 1:12, \n                     labels = c(\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\",\n                                \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\")) +\n  scale_y_continuous(labels = scales::comma) +\n  labs(\n    title = \"Housing Violations by Month and Year\",\n    subtitle = \"Manhattan, 2022-2025\",\n    x = \"Month\",\n    y = \"Number of Violations\",\n    color = \"Year\"\n  ) +\n  theme_minimal(base_size = 16) +\n  theme(\n    plot.title = element_text(face = \"bold\"),\n    legend.position = \"right\"\n  )\n\n\n\n\n\n\n\n\n\nIt shows that there is no stable seasonal pattern across years. Some months are high in one year and low in another like February is very unsually high only in 2022, while peaks in other years appear in different months like April 2024 or June 2025. Hence, we can conclude that monthly counts fluctuate randomly rather than following a consistent winter–summer or any other repeating trend.\n\n\n3.6.5 Investigating February 2022 peak\n\n\nCode\n# Investigate February 2022\nfeb_2022 &lt;- housing_2[Year == 2022 & Month == 2]\ncat(\"February 2022 violations:\", nrow(feb_2022), \"\\n\")\n\n\nFebruary 2022 violations: 28414 \n\n\nCode\n# Check if they're all inspected in Feb or entered in Feb\nsummary(feb_2022$InspectionDate)\n\n\n        Min.      1st Qu.       Median         Mean      3rd Qu.         Max. \n\"2022-02-01\" \"2022-02-15\" \"2022-02-15\" \"2022-02-15\" \"2022-02-16\" \"2022-02-28\" \n\n\nCode\nsummary(feb_2022$ApprovedDate)\n\n\n   Length     Class      Mode \n    28414 character character \n\n\nUpon further review we can see that Median/Mean inspection date is February 15, 2022 & most inspections are clustered around Feb 15-16 only. This does not seem like a data error but is simply appearing to be a mass inspection event in mid-February 2022. It is not a trend.\n\n\n3.6.6 Smoothed Temporal View\nWe tried to find any overall trends when we smooth out the monthly fluctuations\n\n\nCode\n# Aggregate by quarter for smoother trend\nhousing_2[, Quarter := quarter(InspectionDate)]\nhousing_2[, YearQuarter := paste0(Year, \"-Q\", Quarter)]\n\nviol_by_quarter &lt;- housing_2[, .N, by = .(Year, Quarter, YearQuarter)][order(Year, Quarter)]\n\n# Create quarter labels\nviol_by_quarter[, QuarterLabel := paste0(Year, \"\\nQ\", Quarter)]\n\n# Plot\nggplot(viol_by_quarter, aes(x = factor(YearQuarter, levels = YearQuarter), \n                              y = N, group = 1)) +\n  geom_line(color = \"steelblue\", linewidth = 1.2) +\n  geom_point(color = \"steelblue\", size = 3) +\n  scale_y_continuous(labels = scales::comma) +\n  labs(\n    title = \"Housing Violations by Quarter\",\n    subtitle = \"Manhattan, 2022-2025 (smoothed trend)\",\n    x = \"Quarter\",\n    y = \"Number of Violations\"\n  ) +\n  theme_minimal(base_size = 16) +\n  theme(\n    plot.title = element_text(face = \"bold\"),\n    axis.text.x = element_text(angle = 45, hjust = 1)\n  )\n\n\n\n\n\n\n\n\n\nIt shows that housing violations in Manhattan from 2022-2025 move up and down between quarters but stay in a fairly similar range (30,000–45,000), so there is no strong upward or downward trend. Q4 20205 seems like an anomaly but it is not because it does not include data from mid November - December 2025 data are not fully included, hence it is not any abnormal evidence of a real drop.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Analysis Results</span>"
    ]
  },
  {
    "objectID": "project_code_final.html#top-15-311-complaint-categories",
    "href": "project_code_final.html#top-15-311-complaint-categories",
    "title": "3  NYC Building Violation Analysis",
    "section": "3.10 Top 15 311 Complaint Categories",
    "text": "3.10 Top 15 311 Complaint Categories\n\n\nCode\nsr311 |&gt;\n  filter(!is.na(Category)) |&gt; \n  count(Category) |&gt;\n  slice_max(n, n = 15) |&gt;\n  ggplot(aes(x = reorder(Category, n), y = n)) +\n  geom_col(fill = \"steelblue\") +\n  coord_flip() +\n  labs(title = \"Top 15 311 Complaints Category (Manhattan, 3 Years)\", x = \"\", y = \"Count\", size = 14) +\n  theme_minimal()\n\n\nIgnoring unknown labels:\n• size : \"14\"",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>NYC Building Violation Analysis</span>"
    ]
  },
  {
    "objectID": "project_code_final.html#paralle-coordinated-plot",
    "href": "project_code_final.html#paralle-coordinated-plot",
    "title": "3  NYC Building Violation Analysis",
    "section": "3.17 Paralle Coordinated plot",
    "text": "3.17 Paralle Coordinated plot\n\n\nCode\n#| fig-height: 8\n\nhousing_dt &lt;- housing_2\nsr311_dt   &lt;- as.data.table(sr311)\n\nhousing_dt[, BBL := as.character(BBL)]\nsr311_dt[,  BBL := as.character(BBL)]\n\nviol_severity &lt;- housing_dt[\n  !is.na(BBL) & BBL != \"\",\n  .(\n    ViolationCount = .N,\n    ClassC         = sum(Class == \"C\"),\n    RentImp        = sum(RentImpairing == \"Y\")\n  ),\n  by = BBL\n]\n\nviol_severity[, Pct_ClassC  := ClassC  / ViolationCount]\nviol_severity[, Pct_RentImp := RentImp / ViolationCount]\n\ncomplaints_by_building &lt;- sr311_dt[\n  !is.na(BBL) & BBL != \"\",\n  .(ComplaintCount = .N),\n  by = BBL\n]\n\nbldg_pcp &lt;- merge(\n  viol_severity,\n  complaints_by_building,\n  by = \"BBL\",\n  all.x = TRUE\n)\nbldg_pcp[is.na(ComplaintCount), ComplaintCount := 0]\n\nbldg_pcp_filt &lt;- bldg_pcp[\n  ViolationCount &gt;= 20 | ComplaintCount &gt;= 50\n]\n\npcp_df &lt;- as.data.frame(bldg_pcp_filt[, .(\n  ViolationCount = as.numeric(ViolationCount),\n  ComplaintCount = as.numeric(ComplaintCount),\n  Pct_ClassC     = as.numeric(Pct_ClassC),\n  Pct_RentImp    = as.numeric(Pct_RentImp)\n)])\n\nset.seed(2025)\n\n# Sample 300 buildings\npcp_sample &lt;- pcp_df[sample(nrow(pcp_df), 300), ]\n\n# Create severity groups based on Class C share\npcp_sample$SeverityGroup &lt;- cut(\n  pcp_sample$Pct_ClassC,\n  breaks = c(-Inf, 0.2, 0.5, Inf),\n  labels = c(\"Low C share\", \"Medium C share\", \"High C share\")\n)\n\n\nggparcoord(\n  data        = pcp_sample,\n  columns     = 1:4,\n  groupColumn = \"SeverityGroup\",\n  scale       = \"uniminmax\",\n  alphaLines  = 0.25,          # lighter, smoother\n  showPoints  = FALSE\n) +\n  scale_color_brewer(palette = \"Set1\") +\n  theme_minimal(base_size = 11) +   # smaller base font\n  theme(\n    plot.title   = element_text(face = \"bold\", size = 16),\n    axis.title.x = element_text(size = 11),\n    axis.title.y = element_text(size = 11),\n    axis.text.x  = element_text(size = 9),   # reduce x‑axis text size\n    axis.text.y  = element_text(size = 9),\n    legend.position = \"bottom\",              # legend at bottom\n    legend.title    = element_text(size = 10),\n    legend.text     = element_text(size = 9)\n  ) +\n  labs(\n    title = \"Parallel Coordinates: Sample of Buildings\",\n    x = \"Variables\",\n    y = \"Scaled value\",\n    color = \"Class C share\"\n  )",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>NYC Building Violation Analysis</span>"
    ]
  },
  {
    "objectID": "project_code_final.html#parallel-coordinated-plot",
    "href": "project_code_final.html#parallel-coordinated-plot",
    "title": "3  Analysis Results",
    "section": "3.8 Parallel Coordinated plot",
    "text": "3.8 Parallel Coordinated plot\n\n\nCode\nhousing_dt &lt;- housing_2\nsr311_dt   &lt;- as.data.table(sr311)\n\nhousing_dt[, BBL := as.character(BBL)]\nsr311_dt[,  BBL := as.character(BBL)]\n\nviol_severity &lt;- housing_dt[\n  !is.na(BBL) & BBL != \"\",\n  .(\n    ViolationCount = .N,\n    ClassC         = sum(Class == \"C\"),\n    RentImp        = sum(RentImpairing == \"Y\")\n  ),\n  by = BBL\n]\n\nviol_severity[, Pct_ClassC  := ClassC  / ViolationCount]\nviol_severity[, Pct_RentImp := RentImp / ViolationCount]\n\ncomplaints_by_building &lt;- sr311_dt[\n  !is.na(BBL) & BBL != \"\",\n  .(ComplaintCount = .N),\n  by = BBL\n]\n\nbldg_pcp &lt;- merge(\n  viol_severity,\n  complaints_by_building,\n  by = \"BBL\",\n  all.x = TRUE\n)\nbldg_pcp[is.na(ComplaintCount), ComplaintCount := 0]\n\nbldg_pcp_filt &lt;- bldg_pcp[\n  ViolationCount &gt;= 20 | ComplaintCount &gt;= 50\n]\n\npcp_df &lt;- as.data.frame(bldg_pcp_filt[, .(\n  ViolationCount = as.numeric(ViolationCount),\n  ComplaintCount = as.numeric(ComplaintCount),\n  Pct_ClassC     = as.numeric(Pct_ClassC),\n  Pct_RentImp    = as.numeric(Pct_RentImp)\n)])\n\nset.seed(2025)\n\n# Sample 300 buildings\npcp_sample &lt;- pcp_df[sample(nrow(pcp_df), 300), ]\n\n# Create severity groups based on Class C share\npcp_sample$SeverityGroup &lt;- cut(\n  pcp_sample$Pct_ClassC,\n  breaks = c(-Inf, 0.2, 0.5, Inf),\n  labels = c(\"Low C share\", \"Medium C share\", \"High C share\")\n)\n\n\nggparcoord(\n  data        = pcp_sample,\n  columns     = 1:4,\n  groupColumn = \"SeverityGroup\",\n  scale       = \"uniminmax\",\n  alphaLines  = 0.25,          # lighter, smoother\n  showPoints  = FALSE\n) +\n  scale_color_brewer(palette = \"Set1\") +\n  theme_minimal(base_size = 11) +   # smaller base font\n  theme(\n    plot.title   = element_text(face = \"bold\", size = 16),\n    axis.title.x = element_text(size = 11),\n    axis.title.y = element_text(size = 11),\n    axis.text.x  = element_text(size = 9),   # reduce x‑axis text size\n    axis.text.y  = element_text(size = 9),\n    legend.position = \"bottom\",              # legend at bottom\n    legend.title    = element_text(size = 10),\n    legend.text     = element_text(size = 9)\n  ) +\n  labs(\n    title = \"Parallel Coordinates: Sample of Buildings\",\n    x = \"Variables\",\n    y = \"Scaled value\",\n    color = \"Class C share\"\n  )\n\n\n\n\n\n\n\n\n\nThis plot compares each sampled building violation across 4 variables & groups them by how many Class C violations they have. The only clear pattern we can see here is that buildings with higher share of Class C violations have higher share of rent‑impairing violations but for other variables (total violations, 311 complaints), the 3 groups overlap alot, so there is no simple correlation or strong extra pattern visible.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Analysis Results</span>"
    ]
  },
  {
    "objectID": "project_code_final.html#facet-comparative-panel-housing-vs-311",
    "href": "project_code_final.html#facet-comparative-panel-housing-vs-311",
    "title": "3  Analysis Results",
    "section": "3.5 Facet Comparative Panel (Housing vs 311)",
    "text": "3.5 Facet Comparative Panel (Housing vs 311)\n\n\nCode\n# ----------------------------\n# 1) STANDARDIZE ZIPCODE NAME\n# ----------------------------\n\nhousing2 &lt;- housing |&gt;\n  rename(ZipCode = Postcode) |&gt;\n  # Convert housing block to character type immediately\n  mutate(Block = as.character(Block)) \n\nsr311_2 &lt;- sr311 |&gt;\n  rename(ZipCode = Incident.Zip) |&gt;\n  mutate(\n    # Extract 5 digits starting from the 2nd character (position 2) and removing start zeroes\n    Block = as.character(as.numeric(str_sub(BBL, start = 2, end = 6)))\n  )\n\n\n# ----------------------------\n# 2) CREATE TOP SETS PER VARIABLE (20 each)\n# ----------------------------\n\n# Top 10 ZIPs\nhousing_zip &lt;- housing2 |&gt; filter(!is.na(ZipCode)) |&gt; count(ZipCode) |&gt; slice_max(n, n = 10)\nsr311_zip   &lt;- sr311_2 |&gt; filter(!is.na(ZipCode)) |&gt; count(ZipCode) |&gt; slice_max(n, n = 10)\n\n# Top 10 Streets\nhousing_st &lt;- housing2 |&gt; filter(!is.na(StreetName)) |&gt; count(StreetName) |&gt; slice_max(n, n = 10)\nsr311_st   &lt;- sr311_2 |&gt; filter(!is.na(Street.Name)) |&gt; count(Street.Name) |&gt; slice_max(n, n = 10)\n\n# Top Categories (Housing only but we compare counts against 311 Categories\nhousing_cat &lt;- housing2 |&gt; filter(!is.na(ViolationCategory)) |&gt; count(ViolationCategory) |&gt; slice_max(n, n = 10) |&gt; rename(Category = ViolationCategory)\nsr311_cat   &lt;- sr311_2 |&gt; filter(!is.na(Category)) |&gt; count(Category) |&gt; slice_max(n, n = 10) \n\n# Top 10 Blocks\nhousing_block&lt;- housing2 |&gt; filter(!is.na(Block)) |&gt; count(Block) |&gt; slice_max(n, n = 10)\nsr311_block  &lt;- sr311_2 |&gt; filter(!is.na(Block)) |&gt; count(Block) |&gt; slice_max(n, n = 10)\n\n\n# ----------------------------\n# 3) COMBINE PANELS  (FIXED WITH as.character)\n# ----------------------------\n\nzip_panel &lt;- bind_rows(\n  housing_zip |&gt; mutate(Value = as.character(ZipCode), Source = \"Housing\", Facet = \"ZipCode\"),\n  sr311_zip   |&gt; mutate(Value = as.character(ZipCode), Source = \"311\",     Facet = \"ZipCode\")\n)\n\n\ncategory_panel &lt;- bind_rows(\n  housing_cat |&gt; mutate(Value = as.character(Category), Source = \"Housing\", Facet = \"Category\"),\n  sr311_cat   |&gt; mutate(Value = as.character(Category), Source = \"311\",     Facet = \"Category\")\n)\n\nstreet_panel &lt;- bind_rows(\n  housing_st |&gt; mutate(Value = as.character(StreetName), Source = \"Housing\", Facet = \"StreetName\"),\n  sr311_st   |&gt; mutate(Value = as.character(Street.Name), Source = \"311\",     Facet = \"StreetName\")\n)\n\n\nblock_panel &lt;- bind_rows(\n  housing_block |&gt; mutate(Value = as.character(Block), Source = \"Housing\", Facet = \"Block\"),\n  sr311_block  |&gt; mutate(Value = as.character(Block), Source = \"311\",     Facet = \"Block\")\n)\n\n# ----------------------------\n# 4) FINAL COMBINED PANEL\n# ----------------------------\n\npanel_all &lt;- bind_rows(zip_panel, street_panel, category_panel, block_panel) |&gt;\n  group_by(Facet) |&gt;\n  mutate(Value = fct_reorder(Value, n)) |&gt;\n  ungroup()# ----------------------------\n# 4) FINAL FACETED PLOT\n# ----------------------------\n\nggplot(panel_all, aes(x = Value, y = n, fill = Source)) +\n  geom_col(position = \"dodge\") +\n  coord_flip() +\n  facet_wrap(~ Facet, scales = \"free\", ncol = 2) +\n  scale_y_continuous(labels = scales::comma) +\n  scale_fill_manual(values = c(\"Housing\" = \"purple\", \"311\" = \"pink\")) +\n  labs(\n    title = \"Top Manhattan Characteristics Across\\nHousing Violations and 311 Complaints\",\n    subtitle = \"Blocks, Violation/Complaint Categories,\\nStreet Names, and ZIP Codes\",\n    x = \"\",\n    y = \"Count\",\n    fill = \"Source\"\n  ) +\n  theme_minimal(base_size = 14) +\n  theme(\n    strip.text = element_text(face = \"bold\", size = 9),\n    plot.title = element_text(face = \"bold\", size = 13),\n    plot.subtitle = element_text(size = 10),\n    legend.position = \"top\",\n    axis.text.y = element_text(size = 6),\n    axis.text.x = element_text(size = 6)\n  )",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Analysis Results</span>"
    ]
  },
  {
    "objectID": "project_code_final.html#top-violation-classes",
    "href": "project_code_final.html#top-violation-classes",
    "title": "3  Analysis Results",
    "section": "3.9 Top Violation Classes",
    "text": "3.9 Top Violation Classes\n\n\nCode\n# ===  Violation Class Distribution ===\n# Class definitions: A=Non-Hazardous, B=Hazardous, C=Immediately Hazardous, I=Failure to Register\n\nclass_data &lt;- housing |&gt;\n  filter(!is.na(Class)) |&gt;\n  count(Class, name = \"N\") |&gt;\n  mutate(\n    ClassLabel = case_when(\n      Class == \"A\" ~ \"Class A: Non-Hazardous\",\n      Class == \"B\" ~ \"Class B: Hazardous\",\n      Class == \"C\" ~ \"Class C: Immediately Hazardous\",\n      Class == \"I\" ~ \"Class I: Failure to Register\",\n      TRUE ~ Class\n    )\n  ) |&gt;\n  arrange(desc(N))\n\nggplot(class_data, aes(x = reorder(ClassLabel, N), y = N, fill = Class)) +\n  geom_col(fill = \"steelblue\") +\n  geom_text(aes(label = scales::comma(N)), hjust = -0.1, size = 3) +\n  coord_flip() +\n  scale_y_continuous(labels = scales::comma, expand = expansion(mult = c(0, 0.15))) +\n  labs(\n    title = \"Housing Violations by Severity Class\",\n    subtitle = \"Manhattan, 2022-2025\",\n    x = \"Violation Class\",\n    y = \"Number of Violations\"\n  ) +\n  theme_minimal(base_size = 16) +\n  theme(\n    plot.title = element_text(face = \"bold\", size =12),\n    \n    legend.position = \"none\"\n  )\n\n\n\n\n\n\n\n\n\nMajority of violations (~238k) are classified as hazardous (Class B) followed by immediately hazardous (Class C) which is ~185k violations, indicating very serious safety and habitability concerns in Manhattan. Class B violations, which require correction within 30 days, dominate the landscape. This high proportion of serious violations highlights how important it is to thouroughly inspect a building before renting.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Analysis Results</span>"
    ]
  },
  {
    "objectID": "project_code_final.html#rent-impairing-violation",
    "href": "project_code_final.html#rent-impairing-violation",
    "title": "3  Analysis Results",
    "section": "3.10 Rent-Impairing Violation",
    "text": "3.10 Rent-Impairing Violation\n\n\nCode\n# === Rent-Impairing Violations ===\n\nrent_data &lt;- housing |&gt;\n  filter(!is.na(RentImpairing)) |&gt;\n  count(RentImpairing, name = \"N\") |&gt;\n  mutate(\n    Label = ifelse(\n      RentImpairing == \"Y\",\n      \"Rent-Impairing\\n(affects habitability)\",\n      \"Non-Rent-Impairing\"\n    )\n  )\n\nggplot(rent_data, aes(x = Label, y = N, fill = RentImpairing)) +\n  geom_col() +\n  geom_text(\n    aes(label = paste0(scales::comma(N), \"\\n(\", round(N / sum(N) * 100, 1), \"%)\")),\n    vjust = -0.5,\n    size = 5\n  ) +\n  geom_col(fill = \"steelblue\") +\n  scale_y_continuous(labels = scales::comma, expand = expansion(mult = c(0, 0.5))) +\n  labs(\n    title = \"Rent-Impairing vs Non-Rent-Impairing Violations\",\n    subtitle = \"Manhattan, 2022-2025\",\n    x = \"\",\n    y = \"Number of Violations\"\n  ) +\n  theme_minimal(base_size = 16) +\n  theme(\n    plot.title = element_text(face = \"bold\"),\n    legend.position = \"none\"\n  )\n\n\n\n\n\n\n\n\n\nHere, Non-Rent-Impairing is 542,652 (92.1%) and has the a very big majority while rent-Impairing is only 46,353 (7.9%) which means serious habitability issues. This means only 7.9% directly affect habitability and could legally justify rent withholding but though most violations are non-rent-impairing only, rent-impairing violations represent conditions severe enough to make apartments legally uninhabitable like lack of basics amenities like heat, hot water, or having structural hazards.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Analysis Results</span>"
    ]
  },
  {
    "objectID": "project_code_final.html#import-libraries-dataset-setup-and-cleaning",
    "href": "project_code_final.html#import-libraries-dataset-setup-and-cleaning",
    "title": "3  Analysis Results",
    "section": "",
    "text": "3.1.1 Loading Libraries\n\n\nCode\n# Libraries\nlibrary(dplyr)\nlibrary(lubridate)\nlibrary(janitor)\nlibrary(ggplot2)\nlibrary(ggalluvial)\nlibrary(tidyr)\nlibrary(scales)\nlibrary(data.table)\nlibrary(readr)\nlibrary(tidyverse)\nlibrary(forcats)\nlibrary(stringr)\nlibrary(redav)\nlibrary(GGally)\n\n\n\n\n3.1.2 Loading Housing Violations and 311 Complaints Datasets\n\n\nCode\n# ========== HOUSING VIOLATIONS ==========\nhousing_raw &lt;- read.csv(\"/Users/shreyashetty/Documents/Fall 2025 Courses/EDAV/Final_Project/edav_project/datasets/Housing_Violations_2022_onwards.csv\")\n\n# ========== 311 HOUSING COMPLAINTS ==========\nsr311_raw   &lt;- read.csv(\"/Users/shreyashetty/Documents/Fall 2025 Courses/EDAV/Final_Project/edav_project/datasets/311_Housing_Complaints_2022_onwards.csv\")\n\n\n\n\n3.1.3 Formatting dates and making sure loaded data has only Manhattan Borough entries\nHere, we created a robust set of parse orders for mixed formats in both our datasets. We created cleaned date columns while keep original columns untouched. Also, we added new columns with month-year (Month name + Year) extracted which will be used for alluvial stacks later on\n\n\nCode\n# VALID DATE ORDERS\n\ndate_orders &lt;- c(\"mdY HMS\", \"mdY HM\", \"mdY\", \"Ymd HMS\", \"Ymd\")\n\nhousing &lt;- housing_raw |&gt;\n  mutate(\n    borough_std = toupper(Borough),\n    # PARSE master versions — keep duplicates untouched\n    inspectiondate_clean = parse_date_time(InspectionDate, orders = date_orders),\n    approveddate_clean   = parse_date_time(ApprovedDate, orders = date_orders),\n    certifieddate_clean  = parse_date_time(CertifiedDate, orders = date_orders),\n    novissued_clean      = parse_date_time(NOVIssuedDate, orders = date_orders),\n    statusdate_clean     = parse_date_time(CurrentStatusDate, orders = date_orders),\n    originalcertifybydate_clean = parse_date_time(OriginalCertifyByDate, orders = date_orders),\n    originalcorrectbydate_clean = parse_date_time(OriginalCorrectByDate, orders = date_orders),\n    newcertifybydate_clean = parse_date_time(NewCertifyByDate, orders = date_orders),\n    newcorrectbydate_cean = parse_date_time(NewCorrectByDate, orders = date_orders),\n  ) |&gt;\n  filter(borough_std == \"MANHATTAN\")\n\nsr311 &lt;- sr311_raw |&gt;\n  mutate(\n    borough_std = toupper(Borough),\n    created_clean = parse_date_time(Created.Date, orders = date_orders),\n    closed_clean  = parse_date_time(Closed.Date, orders = date_orders)\n  ) |&gt;\n  filter(borough_std == \"MANHATTAN\")\n\n\n# adding month-year (Month name + Year) columns used for alluvial stacks\n\nhousing &lt;- housing |&gt;\n  mutate(\n    inspection_month = ifelse(!is.na(inspectiondate_clean),\n                              format(floor_date(inspectiondate_clean, \"month\"), \"%B %Y\"),\n                              NA_character_),\n    approved_month = ifelse(!is.na(approveddate_clean), \n                            format(floor_date(approveddate_clean,\"month\"), \"%B %Y\"),\n                            NA_character_),\n    nov_month = ifelse(!is.na(novissued_clean),\n                       format(floor_date(novissued_clean, \"month\"), \"%B %Y\"),\n                       NA_character_),\n    status_month = ifelse(!is.na(statusdate_clean),\n                          format(floor_date(statusdate_clean, \"month\"), \"%B %Y\"),\n                          NA_character_)\n  )\n\n\nHousing Violations updated rows check:\n\n\nCode\n# Hosuing violations rows\nnrow(housing)\n\n\n[1] 589005\n\n\n\n\nCode\nsr311 &lt;- sr311 |&gt;\n  mutate(\n    created_month = ifelse(!is.na(created_clean),\n                           format(floor_date(created_clean, \"month\"), \"%B %Y\"),\n                           NA_character_),\n    closed_month = ifelse(!is.na(closed_clean),\n                           format(floor_date(closed_clean, \"month\"), \"%B %Y\"),\n                           NA_character_)\n)\n\n\n311 Request udpated rows check:\n\n\nCode\n# 311 requests rows updated\nnrow(sr311)\n\n\n[1] 425248\n\n\nThe date columns have been parsed properly and as we can see the both raw data we downloaded, only had data from the Manhattan borough since before and after filtering the number of rows remain same for both datastes i.e. 589005 rows in Housing Violations dataset and 425248 rows in 311 requests dataset.\n\n\n3.1.4 Housing violation decription column data cleaning\n\n\nCode\n## Housing violation description column data cleaning\n\n# First, let's inspect NOVDescription\nhead(housing$NOVDescription, 10)\n\n\n [1] \"(A) § HMC:FILE ANNUAL BEDBUG REPORT IN ACCORDANCE WITH HPD RULE AS DESCRIBED ON THE BACK OF THIS NOTICE OF VIOLATION OR AS DESCRIBED ON HPDâ\\u0080\\u0099S WEBSITE, WWW.NYC.GOV\\\\HPD, SEARCH BED BUGS.\"                                 \n [2] \"§ 27-2005 ADM CODE PAINT METAL IN ACCORDANCE WITH DEPT. REGULATION RADIATOR AT THE SOUTH WALL IN THE KITCHEN LOCATED AT APT 9C, 9th STORY, 3rd APARTMENT FROM EAST AT SOUTH\"                                                           \n [3] \"§ 27-2026 ADM CODE REPAIR THE LEAKY AND/OR DEFECTIVE FAUCETS AT SINK IN THE KITCHENETTE LOCATED AT B-ROOM 3N, 3rd STORY, 1st B-ROOM FROM NORTH AT EAST\"                                                                                \n [4] \"§ 27-2005, 27-2007, 27-2041.1 HMC: REPLACE OR REPAIR THE SELF-CLOSING DOORS THAT IS MISSING OR DEFECTIVE AT BULKHEAD\"                                                                                                                  \n [5] \"§ 27-2026 ADM CODE REPAIR THE LEAKY AND/OR DEFECTIVE FAUCETS AT WASHBASIN IN THE BATHROOM LOCATED AT APT 20B, 2nd STORY, 1st APARTMENT FROM NORTH AT EAST\"                                                                             \n [6] \"§ 27-2046.1 HMC: REPAIR OR REPLACE THE CARBON MONOXIDE DETECTING DEVICE(S). MISSING IN THE ENTIRE APARTMENT LOCATED AT APT 7, 3rd STORY, 1st APARTMENT FROM EAST AT SOUTH\"                                                             \n [7] \"§ 27-2045 ADM CODE REPAIR OR REPLACE THE SMOKE DETECTOR MISSING LOCATED AT APT 2A, 2nd STORY, 1st APARTMENT FROM WEST AT NORTH\"                                                                                                        \n [8] \"§ 27-2046.1 HMC: REPAIR OR REPLACE THE CARBON MONOXIDE DETECTING DEVICE(S). MISSING IN THE ENTIRE APARTMENT LOCATED AT APT 5C, 5th STORY, 1st APARTMENT FROM WEST AT NORTH\"                                                            \n [9] \"§ 27-2045 ADM CODE REPAIR OR REPLACE THE SMOKE DETECTOR MISSING IN THE ENTIRE APARTMENT LOCATED AT APT 5C, 5th STORY, 1st APARTMENT FROM WEST AT NORTH\"                                                                                \n[10] \"§ 27-2005 ADM CODE REPAIR THE BROKEN OR DEFECTIVE PLASTERED SURFACES AND PAINT IN A UNIFORM COLOR EAST WALL APPROX 4SQ FT AND NORTH WALL APPROX 4 SQ FT IN THE BATHROOM LOCATED AT APT 1A, 1st STORY, 2nd APARTMENT FROM SOUTH AT WEST\"\n\n\nCode\n# ========== REFINED CATEGORIZATION ==========\nhousing &lt;- housing |&gt;\n  mutate(\n    ViolationCategory = case_when(\n\n      # 1 — Registration (Class I)\n      Class == \"I\" |\n        str_detect(NOVDescription, regex(\"registration|register\", ignore_case = TRUE)) ~\n        \"REGISTRATION/ADMIN\",\n\n      # 2 — Smoke / CO\n      str_detect(NOVDescription, regex(\"smoke detector|carbon monoxide|co detect\", ignore_case = TRUE)) ~\n        \"SMOKE/CO DETECTOR\",\n\n      # 3 — Heat / Hot Water\n      str_detect(NOVDescription, regex(\"heat|heating|hot water|radiator|boiler|steam|too cold\", ignore_case = TRUE)) ~\n        \"HEAT/HOT WATER\",\n\n      # 4 — Plumbing\n      str_detect(NOVDescription, regex(\"plumb|pipe|faucet|drain|sewer|bathroom|sink|toilet|water supply\", ignore_case = TRUE)) ~\n        \"PLUMBING\",\n\n      # 5 — Water leak\n      str_detect(NOVDescription, regex(\"leak|leaking|leakage|water drip\", ignore_case = TRUE)) ~\n        \"WATER LEAK\",\n\n      # 6 — Paint / Plaster\n      str_detect(NOVDescription, regex(\"paint|plaster|peel|wall|ceiling\", ignore_case = TRUE)) ~\n        \"PAINT/PLASTER\",\n\n      # 7 — Door / Window / Lock\n      str_detect(NOVDescription, regex(\"door|window|lock|self-closing|entrance\", ignore_case = TRUE)) ~\n        \"DOOR/WINDOW/LOCK\",\n\n      # 8 — Pest / Sanitation\n      str_detect(NOVDescription, regex(\"rodent|pest|roach|mice|rat|garbage|infest|sanitation\", ignore_case = TRUE)) ~\n        \"PEST/SANITATION\",\n\n      # 9 — Floor / Ceiling\n      str_detect(NOVDescription, regex(\"floor|tile|carpet|wood floor|ceramic\", ignore_case = TRUE)) ~\n        \"FLOOR/CEILING\",\n\n      # 10 — Elevator\n      str_detect(NOVDescription, regex(\"elevator|lift\", ignore_case = TRUE)) ~\n        \"ELEVATOR\",\n\n      # 11 — Mold\n      str_detect(NOVDescription, regex(\"mold|mildew|moisture\", ignore_case = TRUE)) ~\n        \"MOLD\",\n\n      # 12 — Electrical\n      str_detect(NOVDescription, regex(\"electric|wiring|outlet|light|circuit\", ignore_case = TRUE))  ~ \"ELECTRICAL\",\n\n      # 13 — Gas / Appliances\n      str_detect(NOVDescription, regex(\"gas|appliance|stove\", ignore_case = TRUE)) ~\n        \"GAS/APPLIANCES\",\n\n      # 14 — Ventilation\n      str_detect(NOVDescription, regex(\"ventilat|airflow|exhaust fan\", ignore_case = TRUE)) ~\n        \"VENTILATION\",\n\n      # 15— Fire Safety\n      str_detect(NOVDescription, regex(\"fire|sprinkler|fire escape|extinguish\", ignore_case = TRUE)) ~\n        \"FIRE SAFETY\",\n\n      # 16— Intercom / Bell\n      str_detect(NOVDescription, regex(\"bell|buzzer|intercom\", ignore_case = TRUE)) ~\n        \"BUILDING SYSTEMS\",\n\n      # 17 — Building Management\n      str_detect(NOVDescription, regex(\"janitor|superintendent|building service|super\", ignore_case = TRUE)) ~\n        \"BUILDING MANAGEMENT\",\n\n      # Default\n      TRUE ~ \"OTHER\"\n    )\n  )\n\n# Check distribution of newly created categories\nhousing |&gt;\n  count(ViolationCategory, sort = TRUE) |&gt;\n  print()\n\n\n     ViolationCategory      n\n1        PAINT/PLASTER 127336\n2             PLUMBING  93154\n3     DOOR/WINDOW/LOCK  91860\n4                OTHER  53533\n5      PEST/SANITATION  50753\n6    SMOKE/CO DETECTOR  40227\n7       HEAT/HOT WATER  39990\n8   REGISTRATION/ADMIN  35133\n9           WATER LEAK  23370\n10       FLOOR/CEILING  19633\n11         FIRE SAFETY   7121\n12      GAS/APPLIANCES   4004\n13          ELECTRICAL   1607\n14    BUILDING SYSTEMS    679\n15 BUILDING MANAGEMENT    376\n16                MOLD    118\n17            ELEVATOR     81\n18         VENTILATION     30\n\n\n\n\nCode\n# ========== 311: CATEGORY MAPPING (parallel to housing) ==========\n\n# Compare with 311 Complaint Types\nsr311 |&gt;\n  count(Complaint.Type, sort = TRUE) |&gt;\n  print()\n\n\n                  Complaint.Type      n\n1                 HEAT/HOT WATER 229222\n2                       PLUMBING  50637\n3                  PAINT/PLASTER  44624\n4                     WATER LEAK  30190\n5  General Construction/Plumbing  25207\n6        Maintenance or Facility  20202\n7                       Elevator  16588\n8                       Plumbing   2197\n9                       ELEVATOR   1302\n10          Non-Residential Heat   1094\n11            School Maintenance   1064\n12              OUTSIDE BUILDING    857\n13                    Water Leak    556\n14                Heat/Hot Water    487\n15                 Paint/Plaster    404\n16                          Mold    402\n17  Building Drinking Water Tank     83\n18             Sewer Maintenance     68\n19             Water Maintenance     31\n20            Building Condition     19\n21             Unstable Building     14\n\n\nCode\n# Mapped categories\nsr311 &lt;- sr311 |&gt;\n  mutate(\n    Category = case_when(\n      # Heat / Hot Water\n      str_detect(`Complaint.Type`, regex(\"HEAT|HOT WATER\", ignore_case = TRUE)) ~ \"HEAT/HOT WATER\",\n      \n      # Plumbing\n      str_detect(`Complaint.Type`, regex(\"PLUMBING\", ignore_case = TRUE)) ~ \"PLUMBING\",\n      \n      # Water Leak\n      str_detect(`Complaint.Type`, regex(\"WATER LEAK\", ignore_case = TRUE)) ~ \"WATER LEAK\",\n      \n      # Elevator\n      str_detect(`Complaint.Type`, regex(\"ELEVATOR\", ignore_case = TRUE)) ~ \"ELEVATOR\",\n      \n      # Mold\n      str_detect(`Complaint.Type`, regex(\"MOLD\", ignore_case = TRUE)) ~ \"MOLD\",\n      \n      # PAINT / PLASTER — newly added\n      str_detect(`Complaint.Type`, regex(\"PAINT|PLASTER\", ignore_case = TRUE)) ~ \"PAINT/PLASTER\",\n      \n      # Pest / sanitation based on Complaint.Type AND Descriptor\n      (\n        str_detect(`Complaint.Type`, regex(\"MAINTENANCE|FACILITY\", ignore_case = TRUE)) &\n        str_detect(Descriptor, regex(\"rodent|rodents|mice|rats|mouse|rat|insect|pest\", ignore_case = TRUE))\n      ) ~ \"PEST/SANITATION\",\n      \n      # Fallback\n      TRUE ~ \"OTHER\"\n    )\n  )\n\n# New mapped categories\nsr311 |&gt;\n  count(Category, sort = TRUE) |&gt;\n  print()\n\n\n         Category      n\n1  HEAT/HOT WATER 230803\n2        PLUMBING  78041\n3   PAINT/PLASTER  45028\n4      WATER LEAK  30746\n5        ELEVATOR  17890\n6           OTHER  17784\n7 PEST/SANITATION   4554\n8            MOLD    402\n\n\nHere, manual categorization logic we applied successfully maps unstructured text descriptions (NOVDescriptions) in Housing Violations dataset into unified high-level categories which enables a direct one-to-one comparison between both. We also normalized the categories in 311 Complaints dataset since there were multiple for the same category, ege. there were 2 types “HEAT/HOT WATER” and “Heat/Hot Water” which were merged into 1.\n\n\n3.1.5 Save cleaned CSV copies for reproducibility\n\n\nCode\nwrite.csv(housing, \"datasets/housing_manhattan_3years_clean.csv\", row.names = FALSE)\nwrite.csv(sr311,   \"datasets/sr311_manhattan_3years_clean.csv\", row.names = FALSE)",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Analysis Results</span>"
    ]
  },
  {
    "objectID": "project_code_final.html#year-per-quarter-faceted-plots-for-housing-violations-311-complaints",
    "href": "project_code_final.html#year-per-quarter-faceted-plots-for-housing-violations-311-complaints",
    "title": "3  Analysis Results",
    "section": "3.3 3-year per-quarter faceted plots for Housing Violations & 311 Complaints",
    "text": "3.3 3-year per-quarter faceted plots for Housing Violations & 311 Complaints\n\n\nCode\n# ----- HOUSING: QUARTERLY CATEGORY TRENDS (3-LINE-QTRS) -----\n\nhousing_quarter_lines &lt;- housing |&gt;\n  filter(!is.na(inspectiondate_clean)) |&gt;\n    mutate(\n      year = year(inspectiondate_clean),\n      quarter = paste0(\"Q\", quarter(inspectiondate_clean))\n    ) |&gt;\n      count(year, quarter, ViolationCategory) |&gt;\n        mutate(\n          quarter = factor(quarter, levels = c(\"Q1\",\"Q2\",\"Q3\",\"Q4\"))\n        )\n\nfocus_cats &lt;- c(\n  \"HEAT/HOT WATER\",\n  \"PLUMBING\",\n  \"PAINT/PLASTER\",\n  \"WATER LEAK\",\n  \"ELEVATOR\",\n  \"MOLD\",\n  \"PEST/SANITATION\"\n)\n\nhousing_quarter_lines_focus &lt;- housing_quarter_lines |&gt;\n  dplyr::filter(ViolationCategory %in% focus_cats)\n\nggplot(housing_quarter_lines_focus,\n       aes(x = quarter, y = n, color = factor(year), group = year)) +\n  geom_line(linewidth = 1.2) +\n  geom_point(size = 2.2) +\n  scale_y_continuous(labels = scales::comma) +\n  scale_color_manual(values = c(\"2023\" = \"#E63946\",\n                                \"2024\" = \"#457B9D\",\n                                \"2025\" = \"#2A9D8F\"),\n                     name = \"Year\") +\n  facet_wrap(~ ViolationCategory,\n             scales = \"free_y\",\n             ncol = 2) +    \n  theme_minimal(base_size = 14) +\n  theme(\n    plot.title = element_text(face = \"bold\", size = 17),\n    axis.text.x = element_text(angle = 0),\n    legend.position = \"top\"\n  ) +\n  labs(\n    title = \"Quarterly Housing Violations by Category\",\n    subtitle = \"Manhattan (2022–25) • Selected Categories\",\n    x = \"Quarter\",\n    y = \"Number of Violations\"\n  )\n\n\n\n\n\n\n\n\n\nCode\n# ----- 311: QUARTERLY CATEGORY TRENDS (3-LINE-QTRS) -----\n\nsr311_quarter_lines &lt;- sr311 |&gt;\n  filter(!is.na(created_clean)) |&gt;\n  mutate(\n    year    = year(created_clean),\n    quarter = paste0(\"Q\", quarter(created_clean))\n  ) |&gt;\n  count(year, quarter, Category) |&gt;\n  mutate(\n    quarter = factor(quarter, levels = c(\"Q1\",\"Q2\",\"Q3\",\"Q4\"))\n  )\n\nsr311_quarter_lines_focus &lt;- sr311_quarter_lines |&gt;\n  filter(Category %in% focus_cats)\n\nggplot(sr311_quarter_lines_focus,\n       aes(x = quarter, y = n, color = factor(year), group = year)) +\n  geom_line(linewidth = 1.2) +\n  geom_point(size = 2.2) +\n  scale_y_continuous(labels = scales::comma) +\n  scale_color_manual(values = c(\"2023\" = \"#E63946\",\n                                \"2024\" = \"#457B9D\",\n                                \"2025\" = \"#2A9D8F\"),\n                     name = \"Year\") +\n  facet_wrap(~ Category, scales = \"free_y\", ncol = 2) +\n  theme_minimal(base_size = 14) +\n  theme(\n    plot.title  = element_text(face = \"bold\", size = 17),\n    axis.text.x = element_text(angle = 0),\n    legend.position = \"top\"\n  ) +\n  labs(\n    title    = \"Quarterly 311 Complaints by Category\",\n    subtitle = \"Manhattan (2022-25) • Selected Categories\",\n    x = \"Quarter\",\n    y = \"Number of Complaints\"\n  )\n\n\n\n\n\n\n\n\n\nAcross quarters, HEAT/HOT WATER 311 complaints and housing violations both show a clear seasonal pattern. They spike in Q1, drop sharply in Q2 and Q3 for all 3 years, and rise again Q4 matching winter heating needs. For PLUMBING, PAINT/PLASTER, PEST/SANITATION, WATER LEAK, ELEVATOR, and MOLD, housing violations counts change over the quarters (most show a local peak around Q3), but patterns are less sharp and not perfectly identical so they don’t show a single clear seasonal shape like HEAT/HOT WATER does. Pest and sanitation 311 complaints peak in Q3 in all 3 years, which suggests these problems are most common in late summer, which is also consistent with warmer weather since heat and humidity make it easier for rodents, roaches, and insects to spread, and garbage issues can get worse when it’s so hot. But it’s not as strong or as perfectly consistent across all years. For the other categories for 311 complaints, the quarter‑to‑quarter changes within each panel are relatively small and do not follow a clear, repeated seasonal shape across years.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Analysis Results</span>"
    ]
  },
  {
    "objectID": "project_code_final.html#housing-violation-monthly-transition-alluvial-for-2024-sample",
    "href": "project_code_final.html#housing-violation-monthly-transition-alluvial-for-2024-sample",
    "title": "3  Analysis Results",
    "section": "3.4 Housing Violation Monthly Transition Alluvial for 2024 (Sample)",
    "text": "3.4 Housing Violation Monthly Transition Alluvial for 2024 (Sample)\n\n\nCode\n# ---- Housing Violation 2024 Monthly Transition Alluvial ----\n\nset.seed(200)\nmonth_levels &lt;- c(\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\n                  \"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\")\n\nviol_flow_2024 &lt;- housing |&gt;\n  select(ViolationID, Class,\n         inspectiondate_clean, novissued_clean, statusdate_clean) |&gt;\n  mutate(\n    insp_m = floor_date(inspectiondate_clean, \"month\"),\n    nov_m  = floor_date(novissued_clean,       \"month\"),\n    stat_m = floor_date(statusdate_clean,      \"month\")\n  ) |&gt;\n  filter(!is.na(insp_m),\n         year(insp_m) == 2024,\n         (!is.na(nov_m) | !is.na(stat_m))) |&gt;\n  slice_sample(n = 200) |&gt;\n  mutate(\n    insp_m_lab = factor(format(insp_m, \"%b\"),  levels = month_levels),\n    nov_m_lab  = factor(format(nov_m,  \"%b\"),  levels = month_levels),\n    stat_m_lab = factor(format(stat_m, \"%b\"),  levels = month_levels)\n  ) |&gt;\n  group_by(insp_m_lab, nov_m_lab, stat_m_lab, Class) |&gt;\n  summarise(n = n(), .groups = \"drop\")\n\n\n# plot\nggplot(viol_flow_2024,\n       aes(axis1 = insp_m_lab, axis2 = nov_m_lab, axis3 = stat_m_lab, y = n)) +\n  geom_alluvium(aes(fill = Class),\n                width = 0.3, alpha = 0.9) +   # softer, smoother ribbons\n  geom_stratum(aes(fill = Class),\n               width = 0.3, alpha = 0.2) +\n  geom_text(stat = \"stratum\",\n            aes(label = after_stat(stratum)),\n            size = 3, color = \"black\") +\n  scale_fill_brewer(type=qual, palette = \"Set2\") +\n  scale_y_continuous(labels = scales::comma) +\n  labs(\n    title = \"2024 Housing Violations Flow: Inspection → NOV → Status (Sample)\",\n    x = \"Stage (Month in 2024)\",\n    y = \"Number of violations\"\n  ) +\n  theme_minimal(base_size = 12) +\n  theme(\n    plot.title   = element_text(face = \"bold\", size = 11),\n    legend.title = element_text(face = \"bold\")\n  )\n\n\n\n\n\n\n\n\n\nWe can see how 2024 housing violations (we have taken a small sample slice of 200 here to visualize better) move from inspection month to NOV (notification of violation) month to when current status takes effect, with ribbon colors showing violation Class (A least serious, C most serious, I immediately hazardous). Mostly, flows stay within nearby months across 3 stages showing many violations progress through the process within the same part of the year. Thicker orange and blue ribbons show that Class B and C violations make up most of the pipeline, while Class A is thinner and Class I appears as a smaller set of immediately hazardous cases. There are also some blank bands in NOV step which occur when inspection and status dates are recorded but NOVIssuedDate or Class code is missing, so those months or classes appear as NA.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Analysis Results</span>"
    ]
  },
  {
    "objectID": "project_code_final.html#parallel-coordinates-plot",
    "href": "project_code_final.html#parallel-coordinates-plot",
    "title": "3  Analysis Results",
    "section": "3.8 Parallel Coordinates plot",
    "text": "3.8 Parallel Coordinates plot\n\n\nCode\nhousing_dt &lt;- housing_2\nsr311_dt   &lt;- as.data.table(sr311)\n\nhousing_dt[, BBL := as.character(BBL)]\nsr311_dt[,  BBL := as.character(BBL)]\n\nviol_severity &lt;- housing_dt[\n  !is.na(BBL) & BBL != \"\",\n  .(\n    ViolationCount = .N,\n    ClassC         = sum(Class == \"C\"),\n    RentImp        = sum(RentImpairing == \"Y\")\n  ),\n  by = BBL\n]\n\nviol_severity[, Pct_ClassC  := ClassC  / ViolationCount]\nviol_severity[, Pct_RentImp := RentImp / ViolationCount]\n\ncomplaints_by_building &lt;- sr311_dt[\n  !is.na(BBL) & BBL != \"\",\n  .(ComplaintCount = .N),\n  by = BBL\n]\n\nbldg_pcp &lt;- merge(\n  viol_severity,\n  complaints_by_building,\n  by = \"BBL\",\n  all.x = TRUE\n)\nbldg_pcp[is.na(ComplaintCount), ComplaintCount := 0]\n\nbldg_pcp_filt &lt;- bldg_pcp[\n  ViolationCount &gt;= 20 | ComplaintCount &gt;= 50\n]\n\npcp_df &lt;- as.data.frame(bldg_pcp_filt[, .(\n  ViolationCount = as.numeric(ViolationCount),\n  ComplaintCount = as.numeric(ComplaintCount),\n  Pct_ClassC     = as.numeric(Pct_ClassC),\n  Pct_RentImp    = as.numeric(Pct_RentImp)\n)])\n\nset.seed(2025)\n\n# Sample 300 buildings\npcp_sample &lt;- pcp_df[sample(nrow(pcp_df), 300), ]\n\n# Create severity groups based on Class C share\npcp_sample$SeverityGroup &lt;- cut(\n  pcp_sample$Pct_ClassC,\n  breaks = c(-Inf, 0.2, 0.5, Inf),\n  labels = c(\"Low C share\", \"Medium C share\", \"High C share\")\n)\n\n\nggparcoord(\n  data        = pcp_sample,\n  columns     = 1:4,\n  groupColumn = \"SeverityGroup\",\n  scale       = \"uniminmax\",\n  alphaLines  = 0.25,          # lighter, smoother\n  showPoints  = FALSE\n) +\n  scale_color_brewer(palette = \"Set1\") +\n  theme_minimal(base_size = 11) +   # smaller base font\n  theme(\n    plot.title   = element_text(face = \"bold\", size = 16),\n    axis.title.x = element_text(size = 11),\n    axis.title.y = element_text(size = 11),\n    axis.text.x  = element_text(size = 9),   # reduce x‑axis text size\n    axis.text.y  = element_text(size = 9),\n    legend.position = \"bottom\",              # legend at bottom\n    legend.title    = element_text(size = 10),\n    legend.text     = element_text(size = 9)\n  ) +\n  labs(\n    title = \"Parallel Coordinates: Sample of Buildings\",\n    x = \"Variables\",\n    y = \"Scaled value\",\n    color = \"Share of Class C\"\n  )\n\n\n\n\n\n\n\n\n\nThis plot compares each sampled building violation across 4 variables & groups them by how many Class C violations they have. The only clear pattern we can see here is that buildings with higher share of Class C violations have higher share of rent‑impairing violations but for other variables (total violations, 311 complaints), the 3 groups overlap alot, so there is no simple correlation or strong extra pattern visible.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Analysis Results</span>"
    ]
  }
]